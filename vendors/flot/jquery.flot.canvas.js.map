{"version":3,"sources":["build/node_modules/browser-pack/_prelude.js","build/vendors/flot/build/vendors/flot/jquery.flot.canvas.js"],"names":[],"mappings":"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","file":"jquery.flot.canvas.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/* Flot plugin for drawing all elements of a plot on the canvas.\n\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nFlot normally produces certain elements, like axis labels and the legend, using\nHTML elements. This permits greater interactivity and customization, and often\nlooks better, due to cross-browser canvas text inconsistencies and limitations.\n\nIt can also be desirable to render the plot entirely in canvas, particularly\nif the goal is to save it as an image, or if Flot is being used in a context\nwhere the HTML DOM does not exist, as is the case within Node.js. This plugin\nswitches out Flot's standard drawing operations for canvas-only replacements.\n\nCurrently the plugin supports only axis labels, but it will eventually allow\nevery element of the plot to be rendered directly to canvas.\n\nThe plugin supports these options:\n\n{\n    canvas: boolean\n}\n\nThe \"canvas\" option controls whether full canvas drawing is enabled, making it\npossible to toggle on and off. This is useful when a plot uses HTML text in the\nbrowser, but needs to redraw with canvas text when exporting as an image.\n\n*/\n\n(function($) {\n\n\tvar options = {\n\t\tcanvas: true\n\t};\n\n\tvar render, getTextInfo, addText;\n\n\t// Cache the prototype hasOwnProperty for faster access\n\n\tvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\n\tfunction init(plot, classes) {\n\n\t\tvar Canvas = classes.Canvas;\n\n\t\t// We only want to replace the functions once; the second time around\n\t\t// we would just get our new function back.  This whole replacing of\n\t\t// prototype functions is a disaster, and needs to be changed ASAP.\n\n\t\tif (render == null) {\n\t\t\tgetTextInfo = Canvas.prototype.getTextInfo,\n\t\t\taddText = Canvas.prototype.addText,\n\t\t\trender = Canvas.prototype.render;\n\t\t}\n\n\t\t// Finishes rendering the canvas, including overlaid text\n\n\t\tCanvas.prototype.render = function() {\n\n\t\t\tif (!plot.getOptions().canvas) {\n\t\t\t\treturn render.call(this);\n\t\t\t}\n\n\t\t\tvar context = this.context,\n\t\t\t\tcache = this._textCache;\n\n\t\t\t// For each text layer, render elements marked as active\n\n\t\t\tcontext.save();\n\t\t\tcontext.textBaseline = \"middle\";\n\n\t\t\tfor (var layerKey in cache) {\n\t\t\t\tif (hasOwnProperty.call(cache, layerKey)) {\n\t\t\t\t\tvar layerCache = cache[layerKey];\n\t\t\t\t\tfor (var styleKey in layerCache) {\n\t\t\t\t\t\tif (hasOwnProperty.call(layerCache, styleKey)) {\n\t\t\t\t\t\t\tvar styleCache = layerCache[styleKey],\n\t\t\t\t\t\t\t\tupdateStyles = true;\n\t\t\t\t\t\t\tfor (var key in styleCache) {\n\t\t\t\t\t\t\t\tif (hasOwnProperty.call(styleCache, key)) {\n\n\t\t\t\t\t\t\t\t\tvar info = styleCache[key],\n\t\t\t\t\t\t\t\t\t\tpositions = info.positions,\n\t\t\t\t\t\t\t\t\t\tlines = info.lines;\n\n\t\t\t\t\t\t\t\t\t// Since every element at this level of the cache have the\n\t\t\t\t\t\t\t\t\t// same font and fill styles, we can just change them once\n\t\t\t\t\t\t\t\t\t// using the values from the first element.\n\n\t\t\t\t\t\t\t\t\tif (updateStyles) {\n\t\t\t\t\t\t\t\t\t\tcontext.fillStyle = info.font.color;\n\t\t\t\t\t\t\t\t\t\tcontext.font = info.font.definition;\n\t\t\t\t\t\t\t\t\t\tupdateStyles = false;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tfor (var i = 0, position; position = positions[i]; i++) {\n\t\t\t\t\t\t\t\t\t\tif (position.active) {\n\t\t\t\t\t\t\t\t\t\t\tfor (var j = 0, line; line = position.lines[j]; j++) {\n\t\t\t\t\t\t\t\t\t\t\t\tcontext.fillText(lines[j].text, line[0], line[1]);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tpositions.splice(i--, 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (positions.length == 0) {\n\t\t\t\t\t\t\t\t\t\tdelete styleCache[key];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontext.restore();\n\t\t};\n\n\t\t// Creates (if necessary) and returns a text info object.\n\t\t//\n\t\t// When the canvas option is set, the object looks like this:\n\t\t//\n\t\t// {\n\t\t//     width: Width of the text's bounding box.\n\t\t//     height: Height of the text's bounding box.\n\t\t//     positions: Array of positions at which this text is drawn.\n\t\t//     lines: [{\n\t\t//         height: Height of this line.\n\t\t//         widths: Width of this line.\n\t\t//         text: Text on this line.\n\t\t//     }],\n\t\t//     font: {\n\t\t//         definition: Canvas font property string.\n\t\t//         color: Color of the text.\n\t\t//     },\n\t\t// }\n\t\t//\n\t\t// The positions array contains objects that look like this:\n\t\t//\n\t\t// {\n\t\t//     active: Flag indicating whether the text should be visible.\n\t\t//     lines: Array of [x, y] coordinates at which to draw the line.\n\t\t//     x: X coordinate at which to draw the text.\n\t\t//     y: Y coordinate at which to draw the text.\n\t\t// }\n\n\t\tCanvas.prototype.getTextInfo = function(layer, text, font, angle, width) {\n\n\t\t\tif (!plot.getOptions().canvas) {\n\t\t\t\treturn getTextInfo.call(this, layer, text, font, angle, width);\n\t\t\t}\n\n\t\t\tvar textStyle, layerCache, styleCache, info;\n\n\t\t\t// Cast the value to a string, in case we were given a number\n\n\t\t\ttext = \"\" + text;\n\n\t\t\t// If the font is a font-spec object, generate a CSS definition\n\n\t\t\tif (typeof font === \"object\") {\n\t\t\t\ttextStyle = font.style + \" \" + font.variant + \" \" + font.weight + \" \" + font.size + \"px \" + font.family;\n\t\t\t} else {\n\t\t\t\ttextStyle = font;\n\t\t\t}\n\n\t\t\t// Retrieve (or create) the cache for the text's layer and styles\n\n\t\t\tlayerCache = this._textCache[layer];\n\n\t\t\tif (layerCache == null) {\n\t\t\t\tlayerCache = this._textCache[layer] = {};\n\t\t\t}\n\n\t\t\tstyleCache = layerCache[textStyle];\n\n\t\t\tif (styleCache == null) {\n\t\t\t\tstyleCache = layerCache[textStyle] = {};\n\t\t\t}\n\n\t\t\tinfo = styleCache[text];\n\n\t\t\tif (info == null) {\n\n\t\t\t\tvar context = this.context;\n\n\t\t\t\t// If the font was provided as CSS, create a div with those\n\t\t\t\t// classes and examine it to generate a canvas font spec.\n\n\t\t\t\tif (typeof font !== \"object\") {\n\n\t\t\t\t\tvar element = $(\"<div>&nbsp;</div>\")\n\t\t\t\t\t\t.css(\"position\", \"absolute\")\n\t\t\t\t\t\t.addClass(typeof font === \"string\" ? font : null)\n\t\t\t\t\t\t.appendTo(this.getTextLayer(layer));\n\n\t\t\t\t\tfont = {\n\t\t\t\t\t\tlineHeight: element.height(),\n\t\t\t\t\t\tstyle: element.css(\"font-style\"),\n\t\t\t\t\t\tvariant: element.css(\"font-variant\"),\n\t\t\t\t\t\tweight: element.css(\"font-weight\"),\n\t\t\t\t\t\tfamily: element.css(\"font-family\"),\n\t\t\t\t\t\tcolor: element.css(\"color\")\n\t\t\t\t\t};\n\n\t\t\t\t\t// Setting line-height to 1, without units, sets it equal\n\t\t\t\t\t// to the font-size, even if the font-size is abstract,\n\t\t\t\t\t// like 'smaller'.  This enables us to read the real size\n\t\t\t\t\t// via the element's height, working around browsers that\n\t\t\t\t\t// return the literal 'smaller' value.\n\n\t\t\t\t\tfont.size = element.css(\"line-height\", 1).height();\n\n\t\t\t\t\telement.remove();\n\t\t\t\t}\n\n\t\t\t\ttextStyle = font.style + \" \" + font.variant + \" \" + font.weight + \" \" + font.size + \"px \" + font.family;\n\n\t\t\t\t// Create a new info object, initializing the dimensions to\n\t\t\t\t// zero so we can count them up line-by-line.\n\n\t\t\t\tinfo = styleCache[text] = {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpositions: [],\n\t\t\t\t\tlines: [],\n\t\t\t\t\tfont: {\n\t\t\t\t\t\tdefinition: textStyle,\n\t\t\t\t\t\tcolor: font.color\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tcontext.save();\n\t\t\t\tcontext.font = textStyle;\n\n\t\t\t\t// Canvas can't handle multi-line strings; break on various\n\t\t\t\t// newlines, including HTML brs, to build a list of lines.\n\t\t\t\t// Note that we could split directly on regexps, but IE < 9 is\n\t\t\t\t// broken; revisit when we drop IE 7/8 support.\n\n\t\t\t\tvar lines = (text + \"\").replace(/<br ?\\/?>|\\r\\n|\\r/g, \"\\n\").split(\"\\n\");\n\n\t\t\t\tfor (var i = 0; i < lines.length; ++i) {\n\n\t\t\t\t\tvar lineText = lines[i],\n\t\t\t\t\t\tmeasured = context.measureText(lineText);\n\n\t\t\t\t\tinfo.width = Math.max(measured.width, info.width);\n\t\t\t\t\tinfo.height += font.lineHeight;\n\n\t\t\t\t\tinfo.lines.push({\n\t\t\t\t\t\ttext: lineText,\n\t\t\t\t\t\twidth: measured.width,\n\t\t\t\t\t\theight: font.lineHeight\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcontext.restore();\n\t\t\t}\n\n\t\t\treturn info;\n\t\t};\n\n\t\t// Adds a text string to the canvas text overlay.\n\n\t\tCanvas.prototype.addText = function(layer, x, y, text, font, angle, width, halign, valign) {\n\n\t\t\tif (!plot.getOptions().canvas) {\n\t\t\t\treturn addText.call(this, layer, x, y, text, font, angle, width, halign, valign);\n\t\t\t}\n\n\t\t\tvar info = this.getTextInfo(layer, text, font, angle, width),\n\t\t\t\tpositions = info.positions,\n\t\t\t\tlines = info.lines;\n\n\t\t\t// Text is drawn with baseline 'middle', which we need to account\n\t\t\t// for by adding half a line's height to the y position.\n\n\t\t\ty += info.height / lines.length / 2;\n\n\t\t\t// Tweak the initial y-position to match vertical alignment\n\n\t\t\tif (valign == \"middle\") {\n\t\t\t\ty = Math.round(y - info.height / 2);\n\t\t\t} else if (valign == \"bottom\") {\n\t\t\t\ty = Math.round(y - info.height);\n\t\t\t} else {\n\t\t\t\ty = Math.round(y);\n\t\t\t}\n\n\t\t\t// FIXME: LEGACY BROWSER FIX\n\t\t\t// AFFECTS: Opera < 12.00\n\n\t\t\t// Offset the y coordinate, since Opera is off pretty\n\t\t\t// consistently compared to the other browsers.\n\n\t\t\tif (!!(window.opera && window.opera.version().split(\".\")[0] < 12)) {\n\t\t\t\ty -= 2;\n\t\t\t}\n\n\t\t\t// Determine whether this text already exists at this position.\n\t\t\t// If so, mark it for inclusion in the next render pass.\n\n\t\t\tfor (var i = 0, position; position = positions[i]; i++) {\n\t\t\t\tif (position.x == x && position.y == y) {\n\t\t\t\t\tposition.active = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If the text doesn't exist at this position, create a new entry\n\n\t\t\tposition = {\n\t\t\t\tactive: true,\n\t\t\t\tlines: [],\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\n\t\t\tpositions.push(position);\n\n\t\t\t// Fill in the x & y positions of each line, adjusting them\n\t\t\t// individually for horizontal alignment.\n\n\t\t\tfor (var i = 0, line; line = lines[i]; i++) {\n\t\t\t\tif (halign == \"center\") {\n\t\t\t\t\tposition.lines.push([Math.round(x - line.width / 2), y]);\n\t\t\t\t} else if (halign == \"right\") {\n\t\t\t\t\tposition.lines.push([Math.round(x - line.width), y]);\n\t\t\t\t} else {\n\t\t\t\t\tposition.lines.push([Math.round(x), y]);\n\t\t\t\t}\n\t\t\t\ty += line.height;\n\t\t\t}\n\t\t};\n\t}\n\n\t$.plot.plugins.push({\n\t\tinit: init,\n\t\toptions: options,\n\t\tname: \"canvas\",\n\t\tversion: \"1.0\"\n\t});\n\n})(jQuery);\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC92ZW5kb3JzL2Zsb3QvanF1ZXJ5LmZsb3QuY2FudmFzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQ0FBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTZCQSxDQUFDLFVBQVMsQ0FBVCxFQUFZOztBQUVaLEtBQUksVUFBVTtBQUNiLFVBQVE7QUFESyxFQUFkOztBQUlBLEtBQUksTUFBSixFQUFZLFdBQVosRUFBeUIsT0FBekI7O0FBRUE7O0FBRUEsS0FBSSxpQkFBaUIsT0FBTyxTQUFQLENBQWlCLGNBQXRDOztBQUVBLFVBQVMsSUFBVCxDQUFjLElBQWQsRUFBb0IsT0FBcEIsRUFBNkI7O0FBRTVCLE1BQUksU0FBUyxRQUFRLE1BQXJCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxNQUFJLFVBQVUsSUFBZCxFQUFvQjtBQUNuQixpQkFBYyxPQUFPLFNBQVAsQ0FBaUIsV0FBL0IsRUFDQSxVQUFVLE9BQU8sU0FBUCxDQUFpQixPQUQzQixFQUVBLFNBQVMsT0FBTyxTQUFQLENBQWlCLE1BRjFCO0FBR0E7O0FBRUQ7O0FBRUEsU0FBTyxTQUFQLENBQWlCLE1BQWpCLEdBQTBCLFlBQVc7O0FBRXBDLE9BQUksQ0FBQyxLQUFLLFVBQUwsR0FBa0IsTUFBdkIsRUFBK0I7QUFDOUIsV0FBTyxPQUFPLElBQVAsQ0FBWSxJQUFaLENBQVA7QUFDQTs7QUFFRCxPQUFJLFVBQVUsS0FBSyxPQUFuQjtBQUFBLE9BQ0MsUUFBUSxLQUFLLFVBRGQ7O0FBR0E7O0FBRUEsV0FBUSxJQUFSO0FBQ0EsV0FBUSxZQUFSLEdBQXVCLFFBQXZCOztBQUVBLFFBQUssSUFBSSxRQUFULElBQXFCLEtBQXJCLEVBQTRCO0FBQzNCLFFBQUksZUFBZSxJQUFmLENBQW9CLEtBQXBCLEVBQTJCLFFBQTNCLENBQUosRUFBMEM7QUFDekMsU0FBSSxhQUFhLE1BQU0sUUFBTixDQUFq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QUVBLGNBQVc7QUFDVixZQUFRLElBREU7QUFFVixXQUFPLEVBRkc7QUFHVixPQUFHLENBSE87QUFJVixPQUFHO0FBSk8sSUFBWDs7QUFPQSxhQUFVLElBQVYsQ0FBZSxRQUFmOztBQUVBO0FBQ0E7O0FBRUEsUUFBSyxJQUFJLElBQUksQ0FBUixFQUFXLElBQWhCLEVBQXNCLE9BQU8sTUFBTSxDQUFOLENBQTdCLEVBQXVDLEdBQXZDLEVBQTRDO0FBQzNDLFFBQUksVUFBVSxRQUFkLEVBQXdCO0FBQ3ZCLGNBQVMsS0FBVCxDQUFlLElBQWYsQ0FBb0IsQ0FBQyxLQUFLLEtBQUwsQ0FBVyxJQUFJLEtBQUssS0FBTCxHQUFhLENBQTVCLENBQUQsRUFBaUMsQ0FBakMsQ0FBcEI7QUFDQSxLQUZELE1BRU8sSUFBSSxVQUFVLE9BQWQsRUFBdUI7QUFDN0IsY0FBUyxLQUFULENBQWUsSUFBZixDQUFvQixDQUFDLEtBQUssS0FBTCxDQUFXLElBQUksS0FBSyxLQUFwQixDQUFELEVBQTZCLENBQTdCLENBQXBCO0FBQ0EsS0FGTSxNQUVBO0FBQ04sY0FBUyxLQUFULENBQWUsSUFBZixDQUFvQixDQUFDLEtBQUssS0FBTCxDQUFXLENBQVgsQ0FBRCxFQUFnQixDQUFoQixDQUFwQjtBQUNBO0FBQ0QsU0FBSyxLQUFLLE1BQVY7QUFDQTtBQUNELEdBckVEO0FBc0VBOztBQUVELEdBQUUsSUFBRixDQUFPLE9BQVAsQ0FBZSxJQUFmLENBQW9CO0FBQ25CLFFBQU0sSUFEYTtBQUVuQixXQUFTLE9BRlU7QUFHbkIsUUFBTSxRQUhhO0FBSW5CLFdBQVM7QUFKVSxFQUFwQjtBQU9BLENBM1RELEVBMlRHLE1BM1RIIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qIEZsb3QgcGx1Z2luIGZvciBkcmF3aW5nIGFsbCBlbGVtZW50cyBvZiBhIHBsb3Qgb24gdGhlIGNhbnZhcy5cblxuQ29weXJpZ2h0IChjKSAyMDA3LTIwMTQgSU9MQSBhbmQgT2xlIExhdXJzZW4uXG5MaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbkZsb3Qgbm9ybWFsbHkgcHJvZHVjZXMgY2VydGFpbiBlbGVtZW50cywgbGlrZSBheGlzIGxhYmVscyBhbmQgdGhlIGxlZ2VuZCwgdXNpbmdcbkhUTUwgZWxlbWVudHMuIFRoaXMgcGVybWl0cyBncmVhdGVyIGludGVyYWN0aXZpdHkgYW5kIGN1c3RvbWl6YXRpb24sIGFuZCBvZnRlblxubG9va3MgYmV0dGVyLCBkdWUgdG8gY3Jvc3MtYnJvd3NlciBjYW52YXMgdGV4dCBpbmNvbnNpc3RlbmNpZXMgYW5kIGxpbWl0YXRpb25zLlxuXG5JdCBjYW4gYWxzbyBiZSBkZXNpcmFibGUgdG8gcmVuZGVyIHRoZSBwbG90IGVudGlyZWx5IGluIGNhbnZhcywgcGFydGljdWxhcmx5XG5pZiB0aGUgZ29hbCBpcyB0byBzYXZlIGl0IGFzIGFuIGltYWdlLCBvciBpZiBGbG90IGlzIGJlaW5nIHVzZWQgaW4gYSBjb250ZXh0XG53aGVyZSB0aGUgSFRNTCBET00gZG9lcyBub3QgZXhpc3QsIGFzIGlzIHRoZSBjYXNlIHdpdGhpbiBOb2RlLmpzLiBUaGlzIHBsdWdpblxuc3dpdGNoZXMgb3V0IEZsb3QncyBzdGFuZGFyZCBkcmF3aW5nIG9wZXJhdGlvbnMgZm9yIGNhbnZhcy1vbmx5IHJlcGxhY2VtZW50cy5cblxuQ3VycmVudGx5IHRoZSBwbHVnaW4gc3VwcG9ydHMgb25seSBheGlzIGxhYmVscywgYnV0IGl0IHdpbGwgZXZlbnR1YWxseSBhbGxvd1xuZXZlcnkgZWxlbWVudCBvZiB0aGUgcGxvdCB0byBiZSByZW5kZXJlZCBkaXJlY3RseSB0byBjYW52YXMuXG5cblRoZSBwbHVnaW4gc3VwcG9ydHMgdGhlc2Ugb3B0aW9uczpcblxue1xuICAgIGNhbnZhczogYm9vbGVhblxufVxuXG5UaGUgXCJjYW52YXNcIiBvcHRpb24gY29udHJvbHMgd2hldGhlciBmdWxsIGNhbnZhcyBkcmF3aW5nIGlzIGVuYWJsZWQsIG1ha2luZyBpdFxucG9zc2libGUgdG8gdG9nZ2xlIG9uIGFuZCBvZmYuIFRoaXMgaXMgdXNlZnVsIHdoZW4gYSBwbG90IHVzZXMgSFRNTCB0ZXh0IGluIHRoZVxuYnJvd3NlciwgYnV0IG5lZWRzIHRvIHJlZHJhdyB3aXRoIGNhbnZhcyB0ZXh0IHdoZW4gZXhwb3J0aW5nIGFzIGFuIGltYWdlLlxuXG4qL1xuXG4oZnVuY3Rpb24oJCkge1xuXG5cdHZhciBvcHRpb25zID0ge1xuXHRcdGNhbnZhczogdHJ1ZVxuXHR9O1xuXG5cdHZhciByZW5kZXIsIGdldFRleHRJbmZvLCBhZGRUZXh0O1xuXG5cdC8vIENhY2hlIHRoZSBwcm90b3R5cGUgaGFzT3duUHJvcGVydHkgZm9yIGZhc3RlciBhY2Nlc3NcblxuXHR2YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG5cdGZ1bmN0aW9uIGluaXQocGxvdCwgY2xhc3Nlcykge1xuXG5cdFx0dmFyIENhbnZhcyA9IGNsYXNzZXMuQ2FudmFzO1xuXG5cdFx0Ly8gV2Ugb25seSB3YW50IHRvIHJlcGxhY2UgdGhlIGZ1bmN0aW9ucyBvbmNlOyB0aGUgc2Vjb25kIHRpbWUgYXJvdW5kXG5cdFx0Ly8gd2Ugd291bGQganVzdCBnZXQgb3VyIG5ldyBmdW5jdGlvbiBiYWNrLiAgVGhpcyB3aG9sZSByZXBsYWNpbmcgb2Zcblx0XHQvLyBwcm90b3R5cGUgZnVuY3Rpb25zIGlzIGEgZGlzYXN0ZXIsIGFuZCBuZWVkcyB0byBiZSBjaGFuZ2VkIEFTQVAuXG5cblx0XHRpZiAocmVuZGVyID09IG51bGwpIHtcblx0XHRcdGdldFRleHRJbmZvID0gQ2FudmFzLnByb3RvdHlwZS5nZXRUZXh0SW5mbyxcblx0XHRcdGFkZFRleHQgPSBDYW52YXMucHJvdG90eXBlLmFkZFRleHQsXG5cdFx0XHRyZW5kZXIgPSBDYW52YXMucHJvdG90eXBlLnJlbmRlcjtcblx0XHR9XG5cblx0XHQvLyBGaW5pc2hlcyByZW5kZXJpbmcgdGhlIGNhbnZhcywgaW5jbHVkaW5nIG92ZXJsYWlkIHRleHRcblxuXHRcdENhbnZhcy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdGlmICghcGxvdC5nZXRPcHRpb25zKCkuY2FudmFzKSB7XG5cdFx0XHRcdHJldHVybiByZW5kZXIuY2FsbCh0aGlzKTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHQsXG5cdFx0XHRcdGNhY2hlID0gdGhpcy5fdGV4dENhY2hlO1xuXG5cdFx0XHQvLyBGb3IgZWFjaCB0ZXh0IGxheWVyLCByZW5kZXIgZWxlbWVudHMgbWFya2VkIGFzIGFjdGl2ZVxuXG5cdFx0XHRjb250ZXh0LnNhdmUoKTtcblx0XHRcdGNvbnRleHQudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcblxuXHRcdFx0Zm9yICh2YXIgbGF5ZXJLZXkgaW4gY2FjaGUpIHtcblx0XHRcdFx0aWYgKGhhc093blByb3BlcnR5LmNhbGwoY2FjaGUsIGxheWVyS2V5KSkge1xuXHRcdFx0XHRcdHZhciBsYXllckNhY2hlID0gY2FjaGVbbGF5ZXJLZXldO1xuXHRcdFx0XHRcdGZvciAodmFyIHN0eWxlS2V5IGluIGxheWVyQ2FjaGUpIHtcblx0XHRcdFx0XHRcdGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGxheWVyQ2FjaGUsIHN0eWxlS2V5KSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgc3R5bGVDYWNoZSA9IGxheWVyQ2FjaGVbc3R5bGVLZXldLFxuXHRcdFx0XHRcdFx0XHRcdHVwZGF0ZVN0eWxlcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBzdHlsZUNhY2hlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGhhc093blByb3BlcnR5LmNhbGwoc3R5bGVDYWNoZSwga2V5KSkge1xuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgaW5mbyA9IHN0eWxlQ2FjaGVba2V5XSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0cG9zaXRpb25zID0gaW5mby5wb3NpdGlvbnMsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpbmVzID0gaW5mby5saW5lcztcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2luY2UgZXZlcnkgZWxlbWVudCBhdCB0aGlzIGxldmVsIG9mIHRoZSBjYWNoZSBoYXZlIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gc2FtZSBmb250IGFuZCBmaWxsIHN0eWxlcywgd2UgY2FuIGp1c3QgY2hhbmdlIHRoZW0gb25jZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gdXNpbmcgdGhlIHZhbHVlcyBmcm9tIHRoZSBmaXJzdCBlbGVtZW50LlxuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodXBkYXRlU3R5bGVzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnRleHQuZmlsbFN0eWxlID0gaW5mby5mb250LmNvbG9yO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb250ZXh0LmZvbnQgPSBpbmZvLmZvbnQuZGVmaW5pdGlvbjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dXBkYXRlU3R5bGVzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBwb3NpdGlvbjsgcG9zaXRpb24gPSBwb3NpdGlvbnNbaV07IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocG9zaXRpb24uYWN0aXZlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDAsIGxpbmU7IGxpbmUgPSBwb3NpdGlvbi5saW5lc1tqXTsgaisrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb250ZXh0LmZpbGxUZXh0KGxpbmVzW2pdLnRleHQsIGxpbmVbMF0sIGxpbmVbMV0pO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwb3NpdGlvbnMuc3BsaWNlKGktLSwgMSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBvc2l0aW9ucy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgc3R5bGVDYWNoZVtrZXldO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRjb250ZXh0LnJlc3RvcmUoKTtcblx0XHR9O1xuXG5cdFx0Ly8gQ3JlYXRlcyAoaWYgbmVjZXNzYXJ5KSBhbmQgcmV0dXJucyBhIHRleHQgaW5mbyBvYmplY3QuXG5cdFx0Ly9cblx0XHQvLyBXaGVuIHRoZSBjYW52YXMgb3B0aW9uIGlzIHNldCwgdGhlIG9iamVjdCBsb29rcyBsaWtlIHRoaXM6XG5cdFx0Ly9cblx0XHQvLyB7XG5cdFx0Ly8gICAgIHdpZHRoOiBXaWR0aCBvZiB0aGUgdGV4dCdzIGJvdW5kaW5nIGJveC5cblx0XHQvLyAgICAgaGVpZ2h0OiBIZWlnaHQgb2YgdGhlIHRleHQncyBib3VuZGluZyBib3guXG5cdFx0Ly8gICAgIHBvc2l0aW9uczogQXJyYXkgb2YgcG9zaXRpb25zIGF0IHdoaWNoIHRoaXMgdGV4dCBpcyBkcmF3bi5cblx0XHQvLyAgICAgbGluZXM6IFt7XG5cdFx0Ly8gICAgICAgICBoZWlnaHQ6IEhlaWdodCBvZiB0aGlzIGxpbmUuXG5cdFx0Ly8gICAgICAgICB3aWR0aHM6IFdpZHRoIG9mIHRoaXMgbGluZS5cblx0XHQvLyAgICAgICAgIHRleHQ6IFRleHQgb24gdGhpcyBsaW5lLlxuXHRcdC8vICAgICB9XSxcblx0XHQvLyAgICAgZm9udDoge1xuXHRcdC8vICAgICAgICAgZGVmaW5pdGlvbjogQ2FudmFzIGZvbnQgcHJvcGVydHkgc3RyaW5nLlxuXHRcdC8vICAgICAgICAgY29sb3I6IENvbG9yIG9mIHRoZSB0ZXh0LlxuXHRcdC8vICAgICB9LFxuXHRcdC8vIH1cblx0XHQvL1xuXHRcdC8vIFRoZSBwb3NpdGlvbnMgYXJyYXkgY29udGFpbnMgb2JqZWN0cyB0aGF0IGxvb2sgbGlrZSB0aGlzOlxuXHRcdC8vXG5cdFx0Ly8ge1xuXHRcdC8vICAgICBhY3RpdmU6IEZsYWcgaW5kaWNhdGluZyB3aGV0aGVyIHRoZSB0ZXh0IHNob3VsZCBiZSB2aXNpYmxlLlxuXHRcdC8vICAgICBsaW5lczogQXJyYXkgb2YgW3gsIHldIGNvb3JkaW5hdGVzIGF0IHdoaWNoIHRvIGRyYXcgdGhlIGxpbmUuXG5cdFx0Ly8gICAgIHg6IFggY29vcmRpbmF0ZSBhdCB3aGljaCB0byBkcmF3IHRoZSB0ZXh0LlxuXHRcdC8vICAgICB5OiBZIGNvb3JkaW5hdGUgYXQgd2hpY2ggdG8gZHJhdyB0aGUgdGV4dC5cblx0XHQvLyB9XG5cblx0XHRDYW52YXMucHJvdG90eXBlLmdldFRleHRJbmZvID0gZnVuY3Rpb24obGF5ZXIsIHRleHQsIGZvbnQsIGFuZ2xlLCB3aWR0aCkge1xuXG5cdFx0XHRpZiAoIXBsb3QuZ2V0T3B0aW9ucygpLmNhbnZhcykge1xuXHRcdFx0XHRyZXR1cm4gZ2V0VGV4dEluZm8uY2FsbCh0aGlzLCBsYXllciwgdGV4dCwgZm9udCwgYW5nbGUsIHdpZHRoKTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHRleHRTdHlsZSwgbGF5ZXJDYWNoZSwgc3R5bGVDYWNoZSwgaW5mbztcblxuXHRcdFx0Ly8gQ2FzdCB0aGUgdmFsdWUgdG8gYSBzdHJpbmcsIGluIGNhc2Ugd2Ugd2VyZSBnaXZlbiBhIG51bWJlclxuXG5cdFx0XHR0ZXh0ID0gXCJcIiArIHRleHQ7XG5cblx0XHRcdC8vIElmIHRoZSBmb250IGlzIGEgZm9udC1zcGVjIG9iamVjdCwgZ2VuZXJhdGUgYSBDU1MgZGVmaW5pdGlvblxuXG5cdFx0XHRpZiAodHlwZW9mIGZvbnQgPT09IFwib2JqZWN0XCIpIHtcblx0XHRcdFx0dGV4dFN0eWxlID0gZm9udC5zdHlsZSArIFwiIFwiICsgZm9udC52YXJpYW50ICsgXCIgXCIgKyBmb250LndlaWdodCArIFwiIFwiICsgZm9udC5zaXplICsgXCJweCBcIiArIGZvbnQuZmFtaWx5O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGV4dFN0eWxlID0gZm9udDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV0cmlldmUgKG9yIGNyZWF0ZSkgdGhlIGNhY2hlIGZvciB0aGUgdGV4dCdzIGxheWVyIGFuZCBzdHlsZXNcblxuXHRcdFx0bGF5ZXJDYWNoZSA9IHRoaXMuX3RleHRDYWNoZVtsYXllcl07XG5cblx0XHRcdGlmIChsYXllckNhY2hlID09IG51bGwpIHtcblx0XHRcdFx0bGF5ZXJDYWNoZSA9IHRoaXMuX3RleHRDYWNoZVtsYXllcl0gPSB7fTtcblx0XHRcdH1cblxuXHRcdFx0c3R5bGVDYWNoZSA9IGxheWVyQ2FjaGVbdGV4dFN0eWxlXTtcblxuXHRcdFx0aWYgKHN0eWxlQ2FjaGUgPT0gbnVsbCkge1xuXHRcdFx0XHRzdHlsZUNhY2hlID0gbGF5ZXJDYWNoZVt0ZXh0U3R5bGVdID0ge307XG5cdFx0XHR9XG5cblx0XHRcdGluZm8gPSBzdHlsZUNhY2hlW3RleHRdO1xuXG5cdFx0XHRpZiAoaW5mbyA9PSBudWxsKSB7XG5cblx0XHRcdFx0dmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHQ7XG5cblx0XHRcdFx0Ly8gSWYgdGhlIGZvbnQgd2FzIHByb3ZpZGVkIGFzIENTUywgY3JlYXRlIGEgZGl2IHdpdGggdGhvc2Vcblx0XHRcdFx0Ly8gY2xhc3NlcyBhbmQgZXhhbWluZSBpdCB0byBnZW5lcmF0ZSBhIGNhbnZhcyBmb250IHNwZWMuXG5cblx0XHRcdFx0aWYgKHR5cGVvZiBmb250ICE9PSBcIm9iamVjdFwiKSB7XG5cblx0XHRcdFx0XHR2YXIgZWxlbWVudCA9ICQoXCI8ZGl2PiZuYnNwOzwvZGl2PlwiKVxuXHRcdFx0XHRcdFx0LmNzcyhcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIilcblx0XHRcdFx0XHRcdC5hZGRDbGFzcyh0eXBlb2YgZm9udCA9PT0gXCJzdHJpbmdcIiA/IGZvbnQgOiBudWxsKVxuXHRcdFx0XHRcdFx0LmFwcGVuZFRvKHRoaXMuZ2V0VGV4dExheWVyKGxheWVyKSk7XG5cblx0XHRcdFx0XHRmb250ID0ge1xuXHRcdFx0XHRcdFx0bGluZUhlaWdodDogZWxlbWVudC5oZWlnaHQoKSxcblx0XHRcdFx0XHRcdHN0eWxlOiBlbGVtZW50LmNzcyhcImZvbnQtc3R5bGVcIiksXG5cdFx0XHRcdFx0XHR2YXJpYW50OiBlbGVtZW50LmNzcyhcImZvbnQtdmFyaWFudFwiKSxcblx0XHRcdFx0XHRcdHdlaWdodDogZWxlbWVudC5jc3MoXCJmb250LXdlaWdodFwiKSxcblx0XHRcdFx0XHRcdGZhbWlseTogZWxlbWVudC5jc3MoXCJmb250LWZhbWlseVwiKSxcblx0XHRcdFx0XHRcdGNvbG9yOiBlbGVtZW50LmNzcyhcImNvbG9yXCIpXG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8vIFNldHRpbmcgbGluZS1oZWlnaHQgdG8gMSwgd2l0aG91dCB1bml0cywgc2V0cyBpdCBlcXVhbFxuXHRcdFx0XHRcdC8vIHRvIHRoZSBmb250LXNpemUsIGV2ZW4gaWYgdGhlIGZvbnQtc2l6ZSBpcyBhYnN0cmFjdCxcblx0XHRcdFx0XHQvLyBsaWtlICdzbWFsbGVyJy4gIFRoaXMgZW5hYmxlcyB1cyB0byByZWFkIHRoZSByZWFsIHNpemVcblx0XHRcdFx0XHQvLyB2aWEgdGhlIGVsZW1lbnQncyBoZWlnaHQsIHdvcmtpbmcgYXJvdW5kIGJyb3dzZXJzIHRoYXRcblx0XHRcdFx0XHQvLyByZXR1cm4gdGhlIGxpdGVyYWwgJ3NtYWxsZXInIHZhbHVlLlxuXG5cdFx0XHRcdFx0Zm9udC5zaXplID0gZWxlbWVudC5jc3MoXCJsaW5lLWhlaWdodFwiLCAxKS5oZWlnaHQoKTtcblxuXHRcdFx0XHRcdGVsZW1lbnQucmVtb3ZlKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0ZXh0U3R5bGUgPSBmb250LnN0eWxlICsgXCIgXCIgKyBmb250LnZhcmlhbnQgKyBcIiBcIiArIGZvbnQud2VpZ2h0ICsgXCIgXCIgKyBmb250LnNpemUgKyBcInB4IFwiICsgZm9udC5mYW1pbHk7XG5cblx0XHRcdFx0Ly8gQ3JlYXRlIGEgbmV3IGluZm8gb2JqZWN0LCBpbml0aWFsaXppbmcgdGhlIGRpbWVuc2lvbnMgdG9cblx0XHRcdFx0Ly8gemVybyBzbyB3ZSBjYW4gY291bnQgdGhlbSB1cCBsaW5lLWJ5LWxpbmUuXG5cblx0XHRcdFx0aW5mbyA9IHN0eWxlQ2FjaGVbdGV4dF0gPSB7XG5cdFx0XHRcdFx0d2lkdGg6IDAsXG5cdFx0XHRcdFx0aGVpZ2h0OiAwLFxuXHRcdFx0XHRcdHBvc2l0aW9uczogW10sXG5cdFx0XHRcdFx0bGluZXM6IFtdLFxuXHRcdFx0XHRcdGZvbnQ6IHtcblx0XHRcdFx0XHRcdGRlZmluaXRpb246IHRleHRTdHlsZSxcblx0XHRcdFx0XHRcdGNvbG9yOiBmb250LmNvbG9yXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGNvbnRleHQuc2F2ZSgpO1xuXHRcdFx0XHRjb250ZXh0LmZvbnQgPSB0ZXh0U3R5bGU7XG5cblx0XHRcdFx0Ly8gQ2FudmFzIGNhbid0IGhhbmRsZSBtdWx0aS1saW5lIHN0cmluZ3M7IGJyZWFrIG9uIHZhcmlvdXNcblx0XHRcdFx0Ly8gbmV3bGluZXMsIGluY2x1ZGluZyBIVE1MIGJycywgdG8gYnVpbGQgYSBsaXN0IG9mIGxpbmVzLlxuXHRcdFx0XHQvLyBOb3RlIHRoYXQgd2UgY291bGQgc3BsaXQgZGlyZWN0bHkgb24gcmVnZXhwcywgYnV0IElFIDwgOSBpc1xuXHRcdFx0XHQvLyBicm9rZW47IHJldmlzaXQgd2hlbiB3ZSBkcm9wIElFIDcvOCBzdXBwb3J0LlxuXG5cdFx0XHRcdHZhciBsaW5lcyA9ICh0ZXh0ICsgXCJcIikucmVwbGFjZSgvPGJyID9cXC8/PnxcXHJcXG58XFxyL2csIFwiXFxuXCIpLnNwbGl0KFwiXFxuXCIpO1xuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHtcblxuXHRcdFx0XHRcdHZhciBsaW5lVGV4dCA9IGxpbmVzW2ldLFxuXHRcdFx0XHRcdFx0bWVhc3VyZWQgPSBjb250ZXh0Lm1lYXN1cmVUZXh0KGxpbmVUZXh0KTtcblxuXHRcdFx0XHRcdGluZm8ud2lkdGggPSBNYXRoLm1heChtZWFzdXJlZC53aWR0aCwgaW5mby53aWR0aCk7XG5cdFx0XHRcdFx0aW5mby5oZWlnaHQgKz0gZm9udC5saW5lSGVpZ2h0O1xuXG5cdFx0XHRcdFx0aW5mby5saW5lcy5wdXNoKHtcblx0XHRcdFx0XHRcdHRleHQ6IGxpbmVUZXh0LFxuXHRcdFx0XHRcdFx0d2lkdGg6IG1lYXN1cmVkLndpZHRoLFxuXHRcdFx0XHRcdFx0aGVpZ2h0OiBmb250LmxpbmVIZWlnaHRcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnRleHQucmVzdG9yZSgpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gaW5mbztcblx0XHR9O1xuXG5cdFx0Ly8gQWRkcyBhIHRleHQgc3RyaW5nIHRvIHRoZSBjYW52YXMgdGV4dCBvdmVybGF5LlxuXG5cdFx0Q2FudmFzLnByb3RvdHlwZS5hZGRUZXh0ID0gZnVuY3Rpb24obGF5ZXIsIHgsIHksIHRleHQsIGZvbnQsIGFuZ2xlLCB3aWR0aCwgaGFsaWduLCB2YWxpZ24pIHtcblxuXHRcdFx0aWYgKCFwbG90LmdldE9wdGlvbnMoKS5jYW52YXMpIHtcblx0XHRcdFx0cmV0dXJuIGFkZFRleHQuY2FsbCh0aGlzLCBsYXllciwgeCwgeSwgdGV4dCwgZm9udCwgYW5nbGUsIHdpZHRoLCBoYWxpZ24sIHZhbGlnbik7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBpbmZvID0gdGhpcy5nZXRUZXh0SW5mbyhsYXllciwgdGV4dCwgZm9udCwgYW5nbGUsIHdpZHRoKSxcblx0XHRcdFx0cG9zaXRpb25zID0gaW5mby5wb3NpdGlvbnMsXG5cdFx0XHRcdGxpbmVzID0gaW5mby5saW5lcztcblxuXHRcdFx0Ly8gVGV4dCBpcyBkcmF3biB3aXRoIGJhc2VsaW5lICdtaWRkbGUnLCB3aGljaCB3ZSBuZWVkIHRvIGFjY291bnRcblx0XHRcdC8vIGZvciBieSBhZGRpbmcgaGFsZiBhIGxpbmUncyBoZWlnaHQgdG8gdGhlIHkgcG9zaXRpb24uXG5cblx0XHRcdHkgKz0gaW5mby5oZWlnaHQgLyBsaW5lcy5sZW5ndGggLyAyO1xuXG5cdFx0XHQvLyBUd2VhayB0aGUgaW5pdGlhbCB5LXBvc2l0aW9uIHRvIG1hdGNoIHZlcnRpY2FsIGFsaWdubWVudFxuXG5cdFx0XHRpZiAodmFsaWduID09IFwibWlkZGxlXCIpIHtcblx0XHRcdFx0eSA9IE1hdGgucm91bmQoeSAtIGluZm8uaGVpZ2h0IC8gMik7XG5cdFx0XHR9IGVsc2UgaWYgKHZhbGlnbiA9PSBcImJvdHRvbVwiKSB7XG5cdFx0XHRcdHkgPSBNYXRoLnJvdW5kKHkgLSBpbmZvLmhlaWdodCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR5ID0gTWF0aC5yb3VuZCh5KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRklYTUU6IExFR0FDWSBCUk9XU0VSIEZJWFxuXHRcdFx0Ly8gQUZGRUNUUzogT3BlcmEgPCAxMi4wMFxuXG5cdFx0XHQvLyBPZmZzZXQgdGhlIHkgY29vcmRpbmF0ZSwgc2luY2UgT3BlcmEgaXMgb2ZmIHByZXR0eVxuXHRcdFx0Ly8gY29uc2lzdGVudGx5IGNvbXBhcmVkIHRvIHRoZSBvdGhlciBicm93c2Vycy5cblxuXHRcdFx0aWYgKCEhKHdpbmRvdy5vcGVyYSAmJiB3aW5kb3cub3BlcmEudmVyc2lvbigpLnNwbGl0KFwiLlwiKVswXSA8IDEyKSkge1xuXHRcdFx0XHR5IC09IDI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIERldGVybWluZSB3aGV0aGVyIHRoaXMgdGV4dCBhbHJlYWR5IGV4aXN0cyBhdCB0aGlzIHBvc2l0aW9uLlxuXHRcdFx0Ly8gSWYgc28sIG1hcmsgaXQgZm9yIGluY2x1c2lvbiBpbiB0aGUgbmV4dCByZW5kZXIgcGFzcy5cblxuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIHBvc2l0aW9uOyBwb3NpdGlvbiA9IHBvc2l0aW9uc1tpXTsgaSsrKSB7XG5cdFx0XHRcdGlmIChwb3NpdGlvbi54ID09IHggJiYgcG9zaXRpb24ueSA9PSB5KSB7XG5cdFx0XHRcdFx0cG9zaXRpb24uYWN0aXZlID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgdGhlIHRleHQgZG9lc24ndCBleGlzdCBhdCB0aGlzIHBvc2l0aW9uLCBjcmVhdGUgYSBuZXcgZW50cnlcblxuXHRcdFx0cG9zaXRpb24gPSB7XG5cdFx0XHRcdGFjdGl2ZTogdHJ1ZSxcblx0XHRcdFx0bGluZXM6IFtdLFxuXHRcdFx0XHR4OiB4LFxuXHRcdFx0XHR5OiB5XG5cdFx0XHR9O1xuXG5cdFx0XHRwb3NpdGlvbnMucHVzaChwb3NpdGlvbik7XG5cblx0XHRcdC8vIEZpbGwgaW4gdGhlIHggJiB5IHBvc2l0aW9ucyBvZiBlYWNoIGxpbmUsIGFkanVzdGluZyB0aGVtXG5cdFx0XHQvLyBpbmRpdmlkdWFsbHkgZm9yIGhvcml6b250YWwgYWxpZ25tZW50LlxuXG5cdFx0XHRmb3IgKHZhciBpID0gMCwgbGluZTsgbGluZSA9IGxpbmVzW2ldOyBpKyspIHtcblx0XHRcdFx0aWYgKGhhbGlnbiA9PSBcImNlbnRlclwiKSB7XG5cdFx0XHRcdFx0cG9zaXRpb24ubGluZXMucHVzaChbTWF0aC5yb3VuZCh4IC0gbGluZS53aWR0aCAvIDIpLCB5XSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoaGFsaWduID09IFwicmlnaHRcIikge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxpbmVzLnB1c2goW01hdGgucm91bmQoeCAtIGxpbmUud2lkdGgpLCB5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cG9zaXRpb24ubGluZXMucHVzaChbTWF0aC5yb3VuZCh4KSwgeV0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHkgKz0gbGluZS5oZWlnaHQ7XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxuXG5cdCQucGxvdC5wbHVnaW5zLnB1c2goe1xuXHRcdGluaXQ6IGluaXQsXG5cdFx0b3B0aW9uczogb3B0aW9ucyxcblx0XHRuYW1lOiBcImNhbnZhc1wiLFxuXHRcdHZlcnNpb246IFwiMS4wXCJcblx0fSk7XG5cbn0pKGpRdWVyeSk7XG4iXX0="}