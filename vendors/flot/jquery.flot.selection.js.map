{"version":3,"sources":["build/node_modules/browser-pack/_prelude.js","build/vendors/flot/build/vendors/flot/jquery.flot.selection.js"],"names":[],"mappings":"AAAA;;;ACAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA,CAAC,UAAU,CAAV,EAAa;AACV,aAAS,IAAT,CAAc,IAAd,EAAoB;AAChB,YAAI,YAAY;AACR,mBAAO,EAAE,GAAG,CAAC,CAAN,EAAS,GAAG,CAAC,CAAb,EADC,EACgB,QAAQ,EAAE,GAAG,CAAC,CAAN,EAAS,GAAG,CAAC,CAAb,EADxB;AAER,kBAAM,KAFE;AAGR,oBAAQ;AAHA,SAAhB;;AAMA;AACA;AACA;AACA;AACA;AACA,YAAI,gBAAgB,EAApB;;AAEA,YAAI,iBAAiB,IAArB;;AAEA,iBAAS,WAAT,CAAqB,CAArB,EAAwB;AACpB,gBAAI,UAAU,MAAd,EAAsB;AAClB,gCAAgB,CAAhB;;AAEA,qBAAK,cAAL,GAAsB,OAAtB,CAA8B,eAA9B,EAA+C,CAAE,cAAF,CAA/C;AACH;AACJ;;AAED,iBAAS,WAAT,CAAqB,CAArB,EAAwB;AACpB,gBAAI,EAAE,KAAF,IAAW,CAAf,EAAmB;AACf;;AAEJ;AACA,qBAAS,IAAT,CAAc,KAAd;;AAEA;AACA,gBAAI,SAAS,aAAT,KAA2B,SAA3B,IAAwC,cAAc,aAAd,IAA+B,IAA3E,EAAiF;AAC7E,8BAAc,aAAd,GAA8B,SAAS,aAAvC;AACA,yBAAS,aAAT,GAAyB,YAAY;AAAE,2BAAO,KAAP;AAAe,iBAAtD;AACH;AACD,gBAAI,SAAS,MAAT,KAAoB,SAApB,IAAiC,cAAc,MAAd,IAAwB,IAA7D,EAAmE;AAC/D,8BAAc,MAAd,GAAuB,SAAS,MAAhC;AACA,yBAAS,MAAT,GAAkB,YAAY;AAAE,2BAAO,KAAP;AAAe,iBAA/C;AACH;;AAED,4BAAgB,UAAU,KAA1B,EAAiC,CAAjC;;AAEA,sBAAU,MAAV,GAAmB,IAAnB;;AAEA;AACA;AACA,6BAAiB,wBAAU,CAAV,EAAa;AAAE,0BAAU,CAAV;AAAe,aAA/C;;AAEA,cAAE,QAAF,EAAY,GAAZ,CAAgB,SAAhB,EAA2B,cAA3B;AACH;;AAED,iBAAS,SAAT,CAAmB,CAAnB,EAAsB;AAClB,6BAAiB,IAAjB;;AAEA;AACA,gBAAI,SAAS,aAAT,KAA2B,SAA/B,EACI,SAAS,aAAT,GAAyB,cAAc,aAAvC;AACJ,gBAAI,SAAS,MAAT,KAAoB,SAAxB,EACI,SAAS,MAAT,GAAkB,cAAc,MAAhC;;AAEJ;AACA,sBAAU,MAAV,GAAmB,KAAnB;AACA,4BAAgB,CAAhB;;AAEA,gBAAI,iBAAJ,EACI,uBADJ,KAEK;AACD;AACA,qBAAK,cAAL,GAAsB,OAAtB,CAA8B,gBAA9B,EAAgD,EAAhD;AACA,qBAAK,cAAL,GAAsB,OAAtB,CAA8B,eAA9B,EAA+C,CAAE,IAAF,CAA/C;AACH;;AAED,mBAAO,KAAP;AACH;;AAED,iBAAS,YAAT,GAAwB;AACpB,gBAAI,CAAC,iBAAL,EACI,OAAO,IAAP;;AAEJ,gBAAI,CAAC,UAAU,IAAf,EAAqB,OAAO,IAAP;;AAErB,gBAAI,IAAI,EAAR;AAAA,gBAAY,KAAK,UAAU,KAA3B;AAAA,gBAAkC,KAAK,UAAU,MAAjD;AACA,cAAE,IAAF,CAAO,KAAK,OAAL,EAAP,EAAuB,UAAU,IAAV,EAAgB,IAAhB,EAAsB;AACzC,oBAAI,KAAK,IAAT,EAAe;AACX,wBAAI,KAAK,KAAK,GAAL,CAAS,GAAG,KAAK,SAAR,CAAT,CAAT;AAAA,wBAAuC,KAAK,KAAK,GAAL,CAAS,GAAG,KAAK,SAAR,CAAT,CAA5C;AACA,sBAAE,IAAF,IAAU,EAAE,MAAM,KAAK,GAAL,CAAS,EAAT,EAAa,EAAb,CAAR,EAA0B,IAAI,KAAK,GAAL,CAAS,EAAT,EAAa,EAAb,CAA9B,EAAV;AACH;AACJ,aALD;AAMA,mBAAO,CAAP;AACH;;AAED,iBAAS,oBAAT,GAAgC;AAC5B,gBAAI,IAAI,cAAR;;AAEA,iBAAK,cAAL,GAAsB,OAAtB,CAA8B,cAA9B,EAA8C,CAAE,CAAF,CAA9C;;AAEA;AACA,gBAAI,EAAE,KAAF,IAAW,EAAE,KAAjB,EACI,KAAK,cAAL,GAAsB,OAAtB,CAA8B,UAA9B,EAA0C,CAAE,EAAE,IAAI,EAAE,KAAF,CAAQ,IAAd,EAAoB,IAAI,EAAE,KAAF,CAAQ,IAAhC,EAAsC,IAAI,EAAE,KAAF,CAAQ,EAAlD,EAAsD,IAAI,EAAE,KAAF,CAAQ,EAAlE,EAAF,CAA1C;AACP;;AAED,iBAAS,KAAT,CAAe,GAAf,EAAoB,KAApB,EAA2B,GAA3B,EAAgC;AAC5B,mBAAO,QAAQ,GAAR,GAAc,GAAd,GAAoB,QAAQ,GAAR,GAAc,GAAd,GAAmB,KAA9C;AACH;;AAED,iBAAS,eAAT,CAAyB,GAAzB,EAA8B,CAA9B,EAAiC;AAC7B,gBAAI,IAAI,KAAK,UAAL,EAAR;AACA,gBAAI,SAAS,KAAK,cAAL,GAAsB,MAAtB,EAAb;AACA,gBAAI,aAAa,KAAK,aAAL,EAAjB;AACA,gBAAI,CAAJ,GAAQ,MAAM,CAAN,EAAS,EAAE,KAAF,GAAU,OAAO,IAAjB,GAAwB,WAAW,IAA5C,EAAkD,KAAK,KAAL,EAAlD,CAAR;AACA,gBAAI,CAAJ,GAAQ,MAAM,CAAN,EAAS,EAAE,KAAF,GAAU,OAAO,GAAjB,GAAuB,WAAW,GAA3C,EAAgD,KAAK,MAAL,EAAhD,CAAR;;AAEA,gBAAI,EAAE,SAAF,CAAY,IAAZ,IAAoB,GAAxB,EACI,IAAI,CAAJ,GAAQ,OAAO,UAAU,KAAjB,GAAyB,CAAzB,GAA6B,KAAK,KAAL,EAArC;;AAEJ,gBAAI,EAAE,SAAF,CAAY,IAAZ,IAAoB,GAAxB,EACI,IAAI,CAAJ,GAAQ,OAAO,UAAU,KAAjB,GAAyB,CAAzB,GAA6B,KAAK,MAAL,EAArC;AACP;;AAED,iBAAS,eAAT,CAAyB,GAAzB,EAA8B;AAC1B,gBAAI,IAAI,KAAJ,IAAa,IAAjB,EACI;;AAEJ,4BAAgB,UAAU,MAA1B,EAAkC,GAAlC;AACA,gBAAI,iBAAJ,EAAuB;AACnB,0BAAU,IAAV,GAAiB,IAAjB;AACA,qBAAK,oBAAL;AACH,aAHD,MAKI,eAAe,IAAf;AACP;;AAED,iBAAS,cAAT,CAAwB,YAAxB,EAAsC;AAClC,gBAAI,UAAU,IAAd,EAAoB;AAChB,0BAAU,IAAV,GAAiB,KAAjB;AACA,qBAAK,oBAAL;AACA,oBAAI,CAAC,YAAL,EACI,KAAK,cAAL,GAAsB,OAAtB,CAA8B,gBAA9B,EAAgD,EAAhD;AACP;AACJ;;AAED;AACA,iBAAS,YAAT,CAAsB,MAAtB,EAA8B,KAA9B,EAAqC;AACjC,gBAAI,IAAJ;AAAA,gBAAU,IAAV;AAAA,gBAAgB,EAAhB;AAAA,gBAAoB,GAApB;AAAA,gBAAyB,OAAO,KAAK,OAAL,EAAhC;;AAEA,iBAAK,IAAI,CAAT,IAAc,IAAd,EAAoB;AAChB,uBAAO,KAAK,CAAL,CAAP;AACA,oBAAI,KAAK,SAAL,IAAkB,KAAtB,EAA6B;AACzB,0BAAM,QAAQ,KAAK,CAAb,GAAiB,MAAvB;AACA,wBAAI,CAAC,OAAO,GAAP,CAAD,IAAgB,KAAK,CAAL,IAAU,CAA9B,EACI,MAAM,QAAQ,MAAd,CAHqB,CAGC;AAC1B,wBAAI,OAAO,GAAP,CAAJ,EAAiB;AACb,+BAAO,OAAO,GAAP,EAAY,IAAnB;AACA,6BAAK,OAAO,GAAP,EAAY,EAAjB;AACA;AACH;AACJ;AACJ;;AAED;AACA,gBAAI,CAAC,OAAO,GAAP,CAAL,EAAkB;AACd,uBAAO,SAAS,GAAT,GAAe,KAAK,QAAL,GAAgB,CAAhB,CAAf,GAAoC,KAAK,QAAL,GAAgB,CAAhB,CAA3C;AACA,uBAAO,OAAO,QAAQ,GAAf,CAAP;AACA,qBAAK,OAAO,QAAQ,GAAf,CAAL;AACH;;AAED;AACA,gBAAI,QAAQ,IAAR,IAAgB,MAAM,IAAtB,IAA8B,OAAO,EAAzC,EAA6C;AACzC,oBAAI,MAAM,IAAV;AACA,uBAAO,EAAP;AACA,qBAAK,GAAL;AACH;;AAED,mBAAO,EAAE,MAAM,IAAR,EAAc,IAAI,EAAlB,EAAsB,MAAM,IAA5B,EAAP;AACH;;AAED,iBAAS,YAAT,CAAsB,MAAtB,EAA8B,YAA9B,EAA4C;AACxC,gBAAI,IAAJ;AAAA,gBAAU,KAAV;AAAA,gBAAiB,IAAI,KAAK,UAAL,EAArB;;AAEA,gBAAI,EAAE,SAAF,CAAY,IAAZ,IAAoB,GAAxB,EAA6B;AACzB,0BAAU,KAAV,CAAgB,CAAhB,GAAoB,CAApB;AACA,0BAAU,MAAV,CAAiB,CAAjB,GAAqB,KAAK,KAAL,EAArB;AACH,aAHD,MAIK;AACD,wBAAQ,aAAa,MAAb,EAAqB,GAArB,CAAR;;AAEA,0BAAU,KAAV,CAAgB,CAAhB,GAAoB,MAAM,IAAN,CAAW,GAAX,CAAe,MAAM,IAArB,CAApB;AACA,0BAAU,MAAV,CAAiB,CAAjB,GAAqB,MAAM,IAAN,CAAW,GAAX,CAAe,MAAM,EAArB,CAArB;AACH;;AAED,gBAAI,EAAE,SAAF,CAAY,IAAZ,IAAoB,GAAxB,EAA6B;AACzB,0BAAU,KAAV,CAAgB,CAAhB,GAAoB,CAApB;AACA,0BAAU,MAAV,CAAiB,CAAjB,GAAqB,KAAK,MAAL,EAArB;AACH,aAHD,MAIK;AACD,wBAAQ,aAAa,MAAb,EAAqB,GAArB,CAAR;;AAEA,0BAAU,KAAV,CAAgB,CAAhB,GAAoB,MAAM,IAAN,CAAW,GAAX,CAAe,MAAM,IAArB,CAApB;AACA,0BAAU,MAAV,CAAiB,CAAjB,GAAqB,MAAM,IAAN,CAAW,GAAX,CAAe,MAAM,EAArB,CAArB;AACH;;AAED,sBAAU,IAAV,GAAiB,IAAjB;AACA,iBAAK,oBAAL;AACA,gBAAI,CAAC,YAAD,IAAiB,iBAArB,EACI;AACP;;AAED,iBAAS,eAAT,GAA2B;AACvB,gBAAI,UAAU,KAAK,UAAL,GAAkB,SAAlB,CAA4B,OAA1C;AACA,mBAAO,KAAK,GAAL,CAAS,UAAU,MAAV,CAAiB,CAAjB,GAAqB,UAAU,KAAV,CAAgB,CAA9C,KAAoD,OAApD,IACH,KAAK,GAAL,CAAS,UAAU,MAAV,CAAiB,CAAjB,GAAqB,UAAU,KAAV,CAAgB,CAA9C,KAAoD,OADxD;AAEH;;AAED,aAAK,cAAL,GAAsB,cAAtB;AACA,aAAK,YAAL,GAAoB,YAApB;AACA,aAAK,YAAL,GAAoB,YAApB;;AAEA,aAAK,KAAL,CAAW,UAAX,CAAsB,IAAtB,CAA2B,UAAS,IAAT,EAAe,WAAf,EAA4B;AACnD,gBAAI,IAAI,KAAK,UAAL,EAAR;AACA,gBAAI,EAAE,SAAF,CAAY,IAAZ,IAAoB,IAAxB,EAA8B;AAC1B,4BAAY,SAAZ,CAAsB,WAAtB;AACA,4BAAY,SAAZ,CAAsB,WAAtB;AACH;AACJ,SAND;;AASA,aAAK,KAAL,CAAW,WAAX,CAAuB,IAAvB,CAA4B,UAAU,IAAV,EAAgB,GAAhB,EAAqB;AAC7C;AACA,gBAAI,UAAU,IAAV,IAAkB,iBAAtB,EAAyC;AACrC,oBAAI,aAAa,KAAK,aAAL,EAAjB;AACA,oBAAI,IAAI,KAAK,UAAL,EAAR;;AAEA,oBAAI,IAAJ;AACA,oBAAI,SAAJ,CAAc,WAAW,IAAzB,EAA+B,WAAW,GAA1C;;AAEA,oBAAI,IAAI,EAAE,KAAF,CAAQ,KAAR,CAAc,EAAE,SAAF,CAAY,KAA1B,CAAR;;AAEA,oBAAI,WAAJ,GAAkB,EAAE,KAAF,CAAQ,GAAR,EAAa,GAAb,EAAkB,QAAlB,EAAlB;AACA,oBAAI,SAAJ,GAAgB,CAAhB;AACA,oBAAI,QAAJ,GAAe,EAAE,SAAF,CAAY,KAA3B;AACA,oBAAI,SAAJ,GAAgB,EAAE,KAAF,CAAQ,GAAR,EAAa,GAAb,EAAkB,QAAlB,EAAhB;;AAEA,oBAAI,IAAI,KAAK,GAAL,CAAS,UAAU,KAAV,CAAgB,CAAzB,EAA4B,UAAU,MAAV,CAAiB,CAA7C,IAAkD,GAA1D;AAAA,oBACI,IAAI,KAAK,GAAL,CAAS,UAAU,KAAV,CAAgB,CAAzB,EAA4B,UAAU,MAAV,CAAiB,CAA7C,IAAkD,GAD1D;AAAA,oBAEI,IAAI,KAAK,GAAL,CAAS,UAAU,MAAV,CAAiB,CAAjB,GAAqB,UAAU,KAAV,CAAgB,CAA9C,IAAmD,CAF3D;AAAA,oBAGI,IAAI,KAAK,GAAL,CAAS,UAAU,MAAV,CAAiB,CAAjB,GAAqB,UAAU,KAAV,CAAgB,CAA9C,IAAmD,CAH3D;;AAKA,oBAAI,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB;AACA,oBAAI,UAAJ,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB;;AAEA,oBAAI,OAAJ;AACH;AACJ,SA1BD;;AA4BA,aAAK,KAAL,CAAW,QAAX,CAAoB,IAApB,CAAyB,UAAU,IAAV,EAAgB,WAAhB,EAA6B;AAClD,wBAAY,MAAZ,CAAmB,WAAnB,EAAgC,WAAhC;AACA,wBAAY,MAAZ,CAAmB,WAAnB,EAAgC,WAAhC;;AAEA,gBAAI,cAAJ,EACI,EAAE,QAAF,EAAY,MAAZ,CAAmB,SAAnB,EAA8B,cAA9B;AACP,SAND;AAQH;;AAED,MAAE,IAAF,CAAO,OAAP,CAAe,IAAf,CAAoB;AAChB,cAAM,IADU;AAEhB,iBAAS;AACL,uBAAW;AACP,sBAAM,IADC,EACK;AACZ,uBAAO,SAFA;AAGP,uBAAO,OAHA,EAGS;AAChB,yBAAS,CAJF,CAII;AAJJ;AADN,SAFO;AAUhB,cAAM,WAVU;AAWhB,iBAAS;AAXO,KAApB;AAaH,CAvRD,EAuRG,MAvRH","file":"jquery.flot.selection.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/* Flot plugin for selecting regions of a plot.\n\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nThe plugin supports these options:\n\nselection: {\n\tmode: null or \"x\" or \"y\" or \"xy\",\n\tcolor: color,\n\tshape: \"round\" or \"miter\" or \"bevel\",\n\tminSize: number of pixels\n}\n\nSelection support is enabled by setting the mode to one of \"x\", \"y\" or \"xy\".\nIn \"x\" mode, the user will only be able to specify the x range, similarly for\n\"y\" mode. For \"xy\", the selection becomes a rectangle where both ranges can be\nspecified. \"color\" is color of the selection (if you need to change the color\nlater on, you can get to it with plot.getOptions().selection.color). \"shape\"\nis the shape of the corners of the selection.\n\n\"minSize\" is the minimum size a selection can be in pixels. This value can\nbe customized to determine the smallest size a selection can be and still\nhave the selection rectangle be displayed. When customizing this value, the\nfact that it refers to pixels, not axis units must be taken into account.\nThus, for example, if there is a bar graph in time mode with BarWidth set to 1\nminute, setting \"minSize\" to 1 will not make the minimum selection size 1\nminute, but rather 1 pixel. Note also that setting \"minSize\" to 0 will prevent\n\"plotunselected\" events from being fired when the user clicks the mouse without\ndragging.\n\nWhen selection support is enabled, a \"plotselected\" event will be emitted on\nthe DOM element you passed into the plot function. The event handler gets a\nparameter with the ranges selected on the axes, like this:\n\n\tplaceholder.bind( \"plotselected\", function( event, ranges ) {\n\t\talert(\"You selected \" + ranges.xaxis.from + \" to \" + ranges.xaxis.to)\n\t\t// similar for yaxis - with multiple axes, the extra ones are in\n\t\t// x2axis, x3axis, ...\n\t});\n\nThe \"plotselected\" event is only fired when the user has finished making the\nselection. A \"plotselecting\" event is fired during the process with the same\nparameters as the \"plotselected\" event, in case you want to know what's\nhappening while it's happening,\n\nA \"plotunselected\" event with no arguments is emitted when the user clicks the\nmouse to remove the selection. As stated above, setting \"minSize\" to 0 will\ndestroy this behavior.\n\nThe plugin allso adds the following methods to the plot object:\n\n- setSelection( ranges, preventEvent )\n\n  Set the selection rectangle. The passed in ranges is on the same form as\n  returned in the \"plotselected\" event. If the selection mode is \"x\", you\n  should put in either an xaxis range, if the mode is \"y\" you need to put in\n  an yaxis range and both xaxis and yaxis if the selection mode is \"xy\", like\n  this:\n\n\tsetSelection({ xaxis: { from: 0, to: 10 }, yaxis: { from: 40, to: 60 } });\n\n  setSelection will trigger the \"plotselected\" event when called. If you don't\n  want that to happen, e.g. if you're inside a \"plotselected\" handler, pass\n  true as the second parameter. If you are using multiple axes, you can\n  specify the ranges on any of those, e.g. as x2axis/x3axis/... instead of\n  xaxis, the plugin picks the first one it sees.\n\n- clearSelection( preventEvent )\n\n  Clear the selection rectangle. Pass in true to avoid getting a\n  \"plotunselected\" event.\n\n- getSelection()\n\n  Returns the current selection in the same format as the \"plotselected\"\n  event. If there's currently no selection, the function returns null.\n\n*/\n\n(function ($) {\n    function init(plot) {\n        var selection = {\n                first: { x: -1, y: -1}, second: { x: -1, y: -1},\n                show: false,\n                active: false\n            };\n\n        // FIXME: The drag handling implemented here should be\n        // abstracted out, there's some similar code from a library in\n        // the navigation plugin, this should be massaged a bit to fit\n        // the Flot cases here better and reused. Doing this would\n        // make this plugin much slimmer.\n        var savedhandlers = {};\n\n        var mouseUpHandler = null;\n        \n        function onMouseMove(e) {\n            if (selection.active) {\n                updateSelection(e);\n                \n                plot.getPlaceholder().trigger(\"plotselecting\", [ getSelection() ]);\n            }\n        }\n\n        function onMouseDown(e) {\n            if (e.which != 1)  // only accept left-click\n                return;\n            \n            // cancel out any text selections\n            document.body.focus();\n\n            // prevent text selection and drag in old-school browsers\n            if (document.onselectstart !== undefined && savedhandlers.onselectstart == null) {\n                savedhandlers.onselectstart = document.onselectstart;\n                document.onselectstart = function () { return false; };\n            }\n            if (document.ondrag !== undefined && savedhandlers.ondrag == null) {\n                savedhandlers.ondrag = document.ondrag;\n                document.ondrag = function () { return false; };\n            }\n\n            setSelectionPos(selection.first, e);\n\n            selection.active = true;\n\n            // this is a bit silly, but we have to use a closure to be\n            // able to whack the same handler again\n            mouseUpHandler = function (e) { onMouseUp(e); };\n            \n            $(document).one(\"mouseup\", mouseUpHandler);\n        }\n\n        function onMouseUp(e) {\n            mouseUpHandler = null;\n            \n            // revert drag stuff for old-school browsers\n            if (document.onselectstart !== undefined)\n                document.onselectstart = savedhandlers.onselectstart;\n            if (document.ondrag !== undefined)\n                document.ondrag = savedhandlers.ondrag;\n\n            // no more dragging\n            selection.active = false;\n            updateSelection(e);\n\n            if (selectionIsSane())\n                triggerSelectedEvent();\n            else {\n                // this counts as a clear\n                plot.getPlaceholder().trigger(\"plotunselected\", [ ]);\n                plot.getPlaceholder().trigger(\"plotselecting\", [ null ]);\n            }\n\n            return false;\n        }\n\n        function getSelection() {\n            if (!selectionIsSane())\n                return null;\n            \n            if (!selection.show) return null;\n\n            var r = {}, c1 = selection.first, c2 = selection.second;\n            $.each(plot.getAxes(), function (name, axis) {\n                if (axis.used) {\n                    var p1 = axis.c2p(c1[axis.direction]), p2 = axis.c2p(c2[axis.direction]); \n                    r[name] = { from: Math.min(p1, p2), to: Math.max(p1, p2) };\n                }\n            });\n            return r;\n        }\n\n        function triggerSelectedEvent() {\n            var r = getSelection();\n\n            plot.getPlaceholder().trigger(\"plotselected\", [ r ]);\n\n            // backwards-compat stuff, to be removed in future\n            if (r.xaxis && r.yaxis)\n                plot.getPlaceholder().trigger(\"selected\", [ { x1: r.xaxis.from, y1: r.yaxis.from, x2: r.xaxis.to, y2: r.yaxis.to } ]);\n        }\n\n        function clamp(min, value, max) {\n            return value < min ? min: (value > max ? max: value);\n        }\n\n        function setSelectionPos(pos, e) {\n            var o = plot.getOptions();\n            var offset = plot.getPlaceholder().offset();\n            var plotOffset = plot.getPlotOffset();\n            pos.x = clamp(0, e.pageX - offset.left - plotOffset.left, plot.width());\n            pos.y = clamp(0, e.pageY - offset.top - plotOffset.top, plot.height());\n\n            if (o.selection.mode == \"y\")\n                pos.x = pos == selection.first ? 0 : plot.width();\n\n            if (o.selection.mode == \"x\")\n                pos.y = pos == selection.first ? 0 : plot.height();\n        }\n\n        function updateSelection(pos) {\n            if (pos.pageX == null)\n                return;\n\n            setSelectionPos(selection.second, pos);\n            if (selectionIsSane()) {\n                selection.show = true;\n                plot.triggerRedrawOverlay();\n            }\n            else\n                clearSelection(true);\n        }\n\n        function clearSelection(preventEvent) {\n            if (selection.show) {\n                selection.show = false;\n                plot.triggerRedrawOverlay();\n                if (!preventEvent)\n                    plot.getPlaceholder().trigger(\"plotunselected\", [ ]);\n            }\n        }\n\n        // function taken from markings support in Flot\n        function extractRange(ranges, coord) {\n            var axis, from, to, key, axes = plot.getAxes();\n\n            for (var k in axes) {\n                axis = axes[k];\n                if (axis.direction == coord) {\n                    key = coord + axis.n + \"axis\";\n                    if (!ranges[key] && axis.n == 1)\n                        key = coord + \"axis\"; // support x1axis as xaxis\n                    if (ranges[key]) {\n                        from = ranges[key].from;\n                        to = ranges[key].to;\n                        break;\n                    }\n                }\n            }\n\n            // backwards-compat stuff - to be removed in future\n            if (!ranges[key]) {\n                axis = coord == \"x\" ? plot.getXAxes()[0] : plot.getYAxes()[0];\n                from = ranges[coord + \"1\"];\n                to = ranges[coord + \"2\"];\n            }\n\n            // auto-reverse as an added bonus\n            if (from != null && to != null && from > to) {\n                var tmp = from;\n                from = to;\n                to = tmp;\n            }\n            \n            return { from: from, to: to, axis: axis };\n        }\n        \n        function setSelection(ranges, preventEvent) {\n            var axis, range, o = plot.getOptions();\n\n            if (o.selection.mode == \"y\") {\n                selection.first.x = 0;\n                selection.second.x = plot.width();\n            }\n            else {\n                range = extractRange(ranges, \"x\");\n\n                selection.first.x = range.axis.p2c(range.from);\n                selection.second.x = range.axis.p2c(range.to);\n            }\n\n            if (o.selection.mode == \"x\") {\n                selection.first.y = 0;\n                selection.second.y = plot.height();\n            }\n            else {\n                range = extractRange(ranges, \"y\");\n\n                selection.first.y = range.axis.p2c(range.from);\n                selection.second.y = range.axis.p2c(range.to);\n            }\n\n            selection.show = true;\n            plot.triggerRedrawOverlay();\n            if (!preventEvent && selectionIsSane())\n                triggerSelectedEvent();\n        }\n\n        function selectionIsSane() {\n            var minSize = plot.getOptions().selection.minSize;\n            return Math.abs(selection.second.x - selection.first.x) >= minSize &&\n                Math.abs(selection.second.y - selection.first.y) >= minSize;\n        }\n\n        plot.clearSelection = clearSelection;\n        plot.setSelection = setSelection;\n        plot.getSelection = getSelection;\n\n        plot.hooks.bindEvents.push(function(plot, eventHolder) {\n            var o = plot.getOptions();\n            if (o.selection.mode != null) {\n                eventHolder.mousemove(onMouseMove);\n                eventHolder.mousedown(onMouseDown);\n            }\n        });\n\n\n        plot.hooks.drawOverlay.push(function (plot, ctx) {\n            // draw selection\n            if (selection.show && selectionIsSane()) {\n                var plotOffset = plot.getPlotOffset();\n                var o = plot.getOptions();\n\n                ctx.save();\n                ctx.translate(plotOffset.left, plotOffset.top);\n\n                var c = $.color.parse(o.selection.color);\n\n                ctx.strokeStyle = c.scale('a', 0.8).toString();\n                ctx.lineWidth = 1;\n                ctx.lineJoin = o.selection.shape;\n                ctx.fillStyle = c.scale('a', 0.4).toString();\n\n                var x = Math.min(selection.first.x, selection.second.x) + 0.5,\n                    y = Math.min(selection.first.y, selection.second.y) + 0.5,\n                    w = Math.abs(selection.second.x - selection.first.x) - 1,\n                    h = Math.abs(selection.second.y - selection.first.y) - 1;\n\n                ctx.fillRect(x, y, w, h);\n                ctx.strokeRect(x, y, w, h);\n\n                ctx.restore();\n            }\n        });\n        \n        plot.hooks.shutdown.push(function (plot, eventHolder) {\n            eventHolder.unbind(\"mousemove\", onMouseMove);\n            eventHolder.unbind(\"mousedown\", onMouseDown);\n            \n            if (mouseUpHandler)\n                $(document).unbind(\"mouseup\", mouseUpHandler);\n        });\n\n    }\n\n    $.plot.plugins.push({\n        init: init,\n        options: {\n            selection: {\n                mode: null, // one of null, \"x\", \"y\" or \"xy\"\n                color: \"#e8cfac\",\n                shape: \"round\", // one of \"round\", \"miter\", or \"bevel\"\n                minSize: 5 // minimum number of pixels\n            }\n        },\n        name: 'selection',\n        version: '1.1'\n    });\n})(jQuery);\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC92ZW5kb3JzL2Zsb3QvanF1ZXJ5LmZsb3Quc2VsZWN0aW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnRkEsQ0FBQyxVQUFVLENBQVYsRUFBYTtBQUNWLGFBQVMsSUFBVCxDQUFjLElBQWQsRUFBb0I7QUFDaEIsWUFBSSxZQUFZO0FBQ1IsbUJBQU8sRUFBRSxHQUFHLENBQUMsQ0FBTixFQUFTLEdBQUcsQ0FBQyxDQUFiLEVBREMsRUFDZ0IsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFOLEVBQVMsR0FBRyxDQUFDLENBQWIsRUFEeEI7QUFFUixrQkFBTSxLQUZFO0FBR1Isb0JBQVE7QUFIQSxTQUFoQjs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBSSxnQkFBZ0IsRUFBcEI7O0FBRUEsWUFBSSxpQkFBaUIsSUFBckI7O0FBRUEsaUJBQVMsV0FBVCxDQUFxQixDQUFyQixFQUF3QjtBQUNwQixnQkFBSSxVQUFVLE1BQWQsRUFBc0I7QUFDbEIsZ0NBQWdCLENBQWhCOztBQUVBLHFCQUFLLGNBQUwsR0FBc0IsT0FBdEIsQ0FBOEIsZUFBOUIsRUFBK0MsQ0FBRSxjQUFGLENBQS9DO0FBQ0g7QUFDSjs7QUFFRCxpQkFBUyxXQUFULENBQXFCLENBQXJCLEVBQXdCO0FBQ3BCLGdCQUFJLEVBQUUsS0FBRixJQUFXLENBQWYsRUFBbUI7QUFDZjs7QUFFSjtBQUNBLHFCQUFTLElBQVQsQ0FBYyxLQUFkOztBQUVBO0FBQ0EsZ0JBQUksU0FBUyxhQUFULEtBQTJCLFNBQTNCLElBQXdDLGNBQWMsYUFBZCxJQUErQixJQUEzRSxFQUFpRjtBQUM3RSw4QkFBYyxhQUFkLEdBQThCLFNBQVMsYUFBdkM7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QUFwQixDQUF5QixVQUFVLElBQVYsRUFBZ0IsV0FBaEIsRUFBNkI7QUFDbEQsd0JBQVksTUFBWixDQUFtQixXQUFuQixFQUFnQyxXQUFoQztBQUNBLHdCQUFZLE1BQVosQ0FBbUIsV0FBbkIsRUFBZ0MsV0FBaEM7O0FBRUEsZ0JBQUksY0FBSixFQUNJLEVBQUUsUUFBRixFQUFZLE1BQVosQ0FBbUIsU0FBbkIsRUFBOEIsY0FBOUI7QUFDUCxTQU5EO0FBUUg7O0FBRUQsTUFBRSxJQUFGLENBQU8sT0FBUCxDQUFlLElBQWYsQ0FBb0I7QUFDaEIsY0FBTSxJQURVO0FBRWhCLGlCQUFTO0FBQ0wsdUJBQVc7QUFDUCxzQkFBTSxJQURDLEVBQ0s7QUFDWix1QkFBTyxTQUZBO0FBR1AsdUJBQU8sT0FIQSxFQUdTO0FBQ2hCLHlCQUFTLENBSkYsQ0FJSTtBQUpKO0FBRE4sU0FGTztBQVVoQixjQUFNLFdBVlU7QUFXaEIsaUJBQVM7QUFYTyxLQUFwQjtBQWFILENBdlJELEVBdVJHLE1BdlJIIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qIEZsb3QgcGx1Z2luIGZvciBzZWxlY3RpbmcgcmVnaW9ucyBvZiBhIHBsb3QuXG5cbkNvcHlyaWdodCAoYykgMjAwNy0yMDE0IElPTEEgYW5kIE9sZSBMYXVyc2VuLlxuTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuXG5UaGUgcGx1Z2luIHN1cHBvcnRzIHRoZXNlIG9wdGlvbnM6XG5cbnNlbGVjdGlvbjoge1xuXHRtb2RlOiBudWxsIG9yIFwieFwiIG9yIFwieVwiIG9yIFwieHlcIixcblx0Y29sb3I6IGNvbG9yLFxuXHRzaGFwZTogXCJyb3VuZFwiIG9yIFwibWl0ZXJcIiBvciBcImJldmVsXCIsXG5cdG1pblNpemU6IG51bWJlciBvZiBwaXhlbHNcbn1cblxuU2VsZWN0aW9uIHN1cHBvcnQgaXMgZW5hYmxlZCBieSBzZXR0aW5nIHRoZSBtb2RlIHRvIG9uZSBvZiBcInhcIiwgXCJ5XCIgb3IgXCJ4eVwiLlxuSW4gXCJ4XCIgbW9kZSwgdGhlIHVzZXIgd2lsbCBvbmx5IGJlIGFibGUgdG8gc3BlY2lmeSB0aGUgeCByYW5nZSwgc2ltaWxhcmx5IGZvclxuXCJ5XCIgbW9kZS4gRm9yIFwieHlcIiwgdGhlIHNlbGVjdGlvbiBiZWNvbWVzIGEgcmVjdGFuZ2xlIHdoZXJlIGJvdGggcmFuZ2VzIGNhbiBiZVxuc3BlY2lmaWVkLiBcImNvbG9yXCIgaXMgY29sb3Igb2YgdGhlIHNlbGVjdGlvbiAoaWYgeW91IG5lZWQgdG8gY2hhbmdlIHRoZSBjb2xvclxubGF0ZXIgb24sIHlvdSBjYW4gZ2V0IHRvIGl0IHdpdGggcGxvdC5nZXRPcHRpb25zKCkuc2VsZWN0aW9uLmNvbG9yKS4gXCJzaGFwZVwiXG5pcyB0aGUgc2hhcGUgb2YgdGhlIGNvcm5lcnMgb2YgdGhlIHNlbGVjdGlvbi5cblxuXCJtaW5TaXplXCIgaXMgdGhlIG1pbmltdW0gc2l6ZSBhIHNlbGVjdGlvbiBjYW4gYmUgaW4gcGl4ZWxzLiBUaGlzIHZhbHVlIGNhblxuYmUgY3VzdG9taXplZCB0byBkZXRlcm1pbmUgdGhlIHNtYWxsZXN0IHNpemUgYSBzZWxlY3Rpb24gY2FuIGJlIGFuZCBzdGlsbFxuaGF2ZSB0aGUgc2VsZWN0aW9uIHJlY3RhbmdsZSBiZSBkaXNwbGF5ZWQuIFdoZW4gY3VzdG9taXppbmcgdGhpcyB2YWx1ZSwgdGhlXG5mYWN0IHRoYXQgaXQgcmVmZXJzIHRvIHBpeGVscywgbm90IGF4aXMgdW5pdHMgbXVzdCBiZSB0YWtlbiBpbnRvIGFjY291bnQuXG5UaHVzLCBmb3IgZXhhbXBsZSwgaWYgdGhlcmUgaXMgYSBiYXIgZ3JhcGggaW4gdGltZSBtb2RlIHdpdGggQmFyV2lkdGggc2V0IHRvIDFcbm1pbnV0ZSwgc2V0dGluZyBcIm1pblNpemVcIiB0byAxIHdpbGwgbm90IG1ha2UgdGhlIG1pbmltdW0gc2VsZWN0aW9uIHNpemUgMVxubWludXRlLCBidXQgcmF0aGVyIDEgcGl4ZWwuIE5vdGUgYWxzbyB0aGF0IHNldHRpbmcgXCJtaW5TaXplXCIgdG8gMCB3aWxsIHByZXZlbnRcblwicGxvdHVuc2VsZWN0ZWRcIiBldmVudHMgZnJvbSBiZWluZyBmaXJlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgbW91c2Ugd2l0aG91dFxuZHJhZ2dpbmcuXG5cbldoZW4gc2VsZWN0aW9uIHN1cHBvcnQgaXMgZW5hYmxlZCwgYSBcInBsb3RzZWxlY3RlZFwiIGV2ZW50IHdpbGwgYmUgZW1pdHRlZCBvblxudGhlIERPTSBlbGVtZW50IHlvdSBwYXNzZWQgaW50byB0aGUgcGxvdCBmdW5jdGlvbi4gVGhlIGV2ZW50IGhhbmRsZXIgZ2V0cyBhXG5wYXJhbWV0ZXIgd2l0aCB0aGUgcmFuZ2VzIHNlbGVjdGVkIG9uIHRoZSBheGVzLCBsaWtlIHRoaXM6XG5cblx0cGxhY2Vob2xkZXIuYmluZCggXCJwbG90c2VsZWN0ZWRcIiwgZnVuY3Rpb24oIGV2ZW50LCByYW5nZXMgKSB7XG5cdFx0YWxlcnQoXCJZb3Ugc2VsZWN0ZWQgXCIgKyByYW5nZXMueGF4aXMuZnJvbSArIFwiIHRvIFwiICsgcmFuZ2VzLnhheGlzLnRvKVxuXHRcdC8vIHNpbWlsYXIgZm9yIHlheGlzIC0gd2l0aCBtdWx0aXBsZSBheGVzLCB0aGUgZXh0cmEgb25lcyBhcmUgaW5cblx0XHQvLyB4MmF4aXMsIHgzYXhpcywgLi4uXG5cdH0pO1xuXG5UaGUgXCJwbG90c2VsZWN0ZWRcIiBldmVudCBpcyBvbmx5IGZpcmVkIHdoZW4gdGhlIHVzZXIgaGFzIGZpbmlzaGVkIG1ha2luZyB0aGVcbnNlbGVjdGlvbi4gQSBcInBsb3RzZWxlY3RpbmdcIiBldmVudCBpcyBmaXJlZCBkdXJpbmcgdGhlIHByb2Nlc3Mgd2l0aCB0aGUgc2FtZVxucGFyYW1ldGVycyBhcyB0aGUgXCJwbG90c2VsZWN0ZWRcIiBldmVudCwgaW4gY2FzZSB5b3Ugd2FudCB0byBrbm93IHdoYXQnc1xuaGFwcGVuaW5nIHdoaWxlIGl0J3MgaGFwcGVuaW5nLFxuXG5BIFwicGxvdHVuc2VsZWN0ZWRcIiBldmVudCB3aXRoIG5vIGFyZ3VtZW50cyBpcyBlbWl0dGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZVxubW91c2UgdG8gcmVtb3ZlIHRoZSBzZWxlY3Rpb24uIEFzIHN0YXRlZCBhYm92ZSwgc2V0dGluZyBcIm1pblNpemVcIiB0byAwIHdpbGxcbmRlc3Ryb3kgdGhpcyBiZWhhdmlvci5cblxuVGhlIHBsdWdpbiBhbGxzbyBhZGRzIHRoZSBmb2xsb3dpbmcgbWV0aG9kcyB0byB0aGUgcGxvdCBvYmplY3Q6XG5cbi0gc2V0U2VsZWN0aW9uKCByYW5nZXMsIHByZXZlbnRFdmVudCApXG5cbiAgU2V0IHRoZSBzZWxlY3Rpb24gcmVjdGFuZ2xlLiBUaGUgcGFzc2VkIGluIHJhbmdlcyBpcyBvbiB0aGUgc2FtZSBmb3JtIGFzXG4gIHJldHVybmVkIGluIHRoZSBcInBsb3RzZWxlY3RlZFwiIGV2ZW50LiBJZiB0aGUgc2VsZWN0aW9uIG1vZGUgaXMgXCJ4XCIsIHlvdVxuICBzaG91bGQgcHV0IGluIGVpdGhlciBhbiB4YXhpcyByYW5nZSwgaWYgdGhlIG1vZGUgaXMgXCJ5XCIgeW91IG5lZWQgdG8gcHV0IGluXG4gIGFuIHlheGlzIHJhbmdlIGFuZCBib3RoIHhheGlzIGFuZCB5YXhpcyBpZiB0aGUgc2VsZWN0aW9uIG1vZGUgaXMgXCJ4eVwiLCBsaWtlXG4gIHRoaXM6XG5cblx0c2V0U2VsZWN0aW9uKHsgeGF4aXM6IHsgZnJvbTogMCwgdG86IDEwIH0sIHlheGlzOiB7IGZyb206IDQwLCB0bzogNjAgfSB9KTtcblxuICBzZXRTZWxlY3Rpb24gd2lsbCB0cmlnZ2VyIHRoZSBcInBsb3RzZWxlY3RlZFwiIGV2ZW50IHdoZW4gY2FsbGVkLiBJZiB5b3UgZG9uJ3RcbiAgd2FudCB0aGF0IHRvIGhhcHBlbiwgZS5nLiBpZiB5b3UncmUgaW5zaWRlIGEgXCJwbG90c2VsZWN0ZWRcIiBoYW5kbGVyLCBwYXNzXG4gIHRydWUgYXMgdGhlIHNlY29uZCBwYXJhbWV0ZXIuIElmIHlvdSBhcmUgdXNpbmcgbXVsdGlwbGUgYXhlcywgeW91IGNhblxuICBzcGVjaWZ5IHRoZSByYW5nZXMgb24gYW55IG9mIHRob3NlLCBlLmcuIGFzIHgyYXhpcy94M2F4aXMvLi4uIGluc3RlYWQgb2ZcbiAgeGF4aXMsIHRoZSBwbHVnaW4gcGlja3MgdGhlIGZpcnN0IG9uZSBpdCBzZWVzLlxuXG4tIGNsZWFyU2VsZWN0aW9uKCBwcmV2ZW50RXZlbnQgKVxuXG4gIENsZWFyIHRoZSBzZWxlY3Rpb24gcmVjdGFuZ2xlLiBQYXNzIGluIHRydWUgdG8gYXZvaWQgZ2V0dGluZyBhXG4gIFwicGxvdHVuc2VsZWN0ZWRcIiBldmVudC5cblxuLSBnZXRTZWxlY3Rpb24oKVxuXG4gIFJldHVybnMgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIGluIHRoZSBzYW1lIGZvcm1hdCBhcyB0aGUgXCJwbG90c2VsZWN0ZWRcIlxuICBldmVudC4gSWYgdGhlcmUncyBjdXJyZW50bHkgbm8gc2VsZWN0aW9uLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBudWxsLlxuXG4qL1xuXG4oZnVuY3Rpb24gKCQpIHtcbiAgICBmdW5jdGlvbiBpbml0KHBsb3QpIHtcbiAgICAgICAgdmFyIHNlbGVjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBmaXJzdDogeyB4OiAtMSwgeTogLTF9LCBzZWNvbmQ6IHsgeDogLTEsIHk6IC0xfSxcbiAgICAgICAgICAgICAgICBzaG93OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vIEZJWE1FOiBUaGUgZHJhZyBoYW5kbGluZyBpbXBsZW1lbnRlZCBoZXJlIHNob3VsZCBiZVxuICAgICAgICAvLyBhYnN0cmFjdGVkIG91dCwgdGhlcmUncyBzb21lIHNpbWlsYXIgY29kZSBmcm9tIGEgbGlicmFyeSBpblxuICAgICAgICAvLyB0aGUgbmF2aWdhdGlvbiBwbHVnaW4sIHRoaXMgc2hvdWxkIGJlIG1hc3NhZ2VkIGEgYml0IHRvIGZpdFxuICAgICAgICAvLyB0aGUgRmxvdCBjYXNlcyBoZXJlIGJldHRlciBhbmQgcmV1c2VkLiBEb2luZyB0aGlzIHdvdWxkXG4gICAgICAgIC8vIG1ha2UgdGhpcyBwbHVnaW4gbXVjaCBzbGltbWVyLlxuICAgICAgICB2YXIgc2F2ZWRoYW5kbGVycyA9IHt9O1xuXG4gICAgICAgIHZhciBtb3VzZVVwSGFuZGxlciA9IG51bGw7XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBvbk1vdXNlTW92ZShlKSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNlbGVjdGlvbihlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBwbG90LmdldFBsYWNlaG9sZGVyKCkudHJpZ2dlcihcInBsb3RzZWxlY3RpbmdcIiwgWyBnZXRTZWxlY3Rpb24oKSBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9uTW91c2VEb3duKGUpIHtcbiAgICAgICAgICAgIGlmIChlLndoaWNoICE9IDEpICAvLyBvbmx5IGFjY2VwdCBsZWZ0LWNsaWNrXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBjYW5jZWwgb3V0IGFueSB0ZXh0IHNlbGVjdGlvbnNcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuZm9jdXMoKTtcblxuICAgICAgICAgICAgLy8gcHJldmVudCB0ZXh0IHNlbGVjdGlvbiBhbmQgZHJhZyBpbiBvbGQtc2Nob29sIGJyb3dzZXJzXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQub25zZWxlY3RzdGFydCAhPT0gdW5kZWZpbmVkICYmIHNhdmVkaGFuZGxlcnMub25zZWxlY3RzdGFydCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc2F2ZWRoYW5kbGVycy5vbnNlbGVjdHN0YXJ0ID0gZG9jdW1lbnQub25zZWxlY3RzdGFydDtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQub25kcmFnICE9PSB1bmRlZmluZWQgJiYgc2F2ZWRoYW5kbGVycy5vbmRyYWcgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNhdmVkaGFuZGxlcnMub25kcmFnID0gZG9jdW1lbnQub25kcmFnO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9uZHJhZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRTZWxlY3Rpb25Qb3Moc2VsZWN0aW9uLmZpcnN0LCBlKTtcblxuICAgICAgICAgICAgc2VsZWN0aW9uLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBiaXQgc2lsbHksIGJ1dCB3ZSBoYXZlIHRvIHVzZSBhIGNsb3N1cmUgdG8gYmVcbiAgICAgICAgICAgIC8vIGFibGUgdG8gd2hhY2sgdGhlIHNhbWUgaGFuZGxlciBhZ2FpblxuICAgICAgICAgICAgbW91c2VVcEhhbmRsZXIgPSBmdW5jdGlvbiAoZSkgeyBvbk1vdXNlVXAoZSk7IH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uZShcIm1vdXNldXBcIiwgbW91c2VVcEhhbmRsZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb25Nb3VzZVVwKGUpIHtcbiAgICAgICAgICAgIG1vdXNlVXBIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gcmV2ZXJ0IGRyYWcgc3R1ZmYgZm9yIG9sZC1zY2hvb2wgYnJvd3NlcnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQub25zZWxlY3RzdGFydCA9IHNhdmVkaGFuZGxlcnMub25zZWxlY3RzdGFydDtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5vbmRyYWcgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5vbmRyYWcgPSBzYXZlZGhhbmRsZXJzLm9uZHJhZztcblxuICAgICAgICAgICAgLy8gbm8gbW9yZSBkcmFnZ2luZ1xuICAgICAgICAgICAgc2VsZWN0aW9uLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdXBkYXRlU2VsZWN0aW9uKGUpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uSXNTYW5lKCkpXG4gICAgICAgICAgICAgICAgdHJpZ2dlclNlbGVjdGVkRXZlbnQoKTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMgY291bnRzIGFzIGEgY2xlYXJcbiAgICAgICAgICAgICAgICBwbG90LmdldFBsYWNlaG9sZGVyKCkudHJpZ2dlcihcInBsb3R1bnNlbGVjdGVkXCIsIFsgXSk7XG4gICAgICAgICAgICAgICAgcGxvdC5nZXRQbGFjZWhvbGRlcigpLnRyaWdnZXIoXCJwbG90c2VsZWN0aW5nXCIsIFsgbnVsbCBdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U2VsZWN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb25Jc1NhbmUoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24uc2hvdykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIHZhciByID0ge30sIGMxID0gc2VsZWN0aW9uLmZpcnN0LCBjMiA9IHNlbGVjdGlvbi5zZWNvbmQ7XG4gICAgICAgICAgICAkLmVhY2gocGxvdC5nZXRBeGVzKCksIGZ1bmN0aW9uIChuYW1lLCBheGlzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF4aXMudXNlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcDEgPSBheGlzLmMycChjMVtheGlzLmRpcmVjdGlvbl0pLCBwMiA9IGF4aXMuYzJwKGMyW2F4aXMuZGlyZWN0aW9uXSk7IFxuICAgICAgICAgICAgICAgICAgICByW25hbWVdID0geyBmcm9tOiBNYXRoLm1pbihwMSwgcDIpLCB0bzogTWF0aC5tYXgocDEsIHAyKSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0cmlnZ2VyU2VsZWN0ZWRFdmVudCgpIHtcbiAgICAgICAgICAgIHZhciByID0gZ2V0U2VsZWN0aW9uKCk7XG5cbiAgICAgICAgICAgIHBsb3QuZ2V0UGxhY2Vob2xkZXIoKS50cmlnZ2VyKFwicGxvdHNlbGVjdGVkXCIsIFsgciBdKTtcblxuICAgICAgICAgICAgLy8gYmFja3dhcmRzLWNvbXBhdCBzdHVmZiwgdG8gYmUgcmVtb3ZlZCBpbiBmdXR1cmVcbiAgICAgICAgICAgIGlmIChyLnhheGlzICYmIHIueWF4aXMpXG4gICAgICAgICAgICAgICAgcGxvdC5nZXRQbGFjZWhvbGRlcigpLnRyaWdnZXIoXCJzZWxlY3RlZFwiLCBbIHsgeDE6IHIueGF4aXMuZnJvbSwgeTE6IHIueWF4aXMuZnJvbSwgeDI6IHIueGF4aXMudG8sIHkyOiByLnlheGlzLnRvIH0gXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjbGFtcChtaW4sIHZhbHVlLCBtYXgpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSA8IG1pbiA/IG1pbjogKHZhbHVlID4gbWF4ID8gbWF4OiB2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTZWxlY3Rpb25Qb3MocG9zLCBlKSB7XG4gICAgICAgICAgICB2YXIgbyA9IHBsb3QuZ2V0T3B0aW9ucygpO1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IHBsb3QuZ2V0UGxhY2Vob2xkZXIoKS5vZmZzZXQoKTtcbiAgICAgICAgICAgIHZhciBwbG90T2Zmc2V0ID0gcGxvdC5nZXRQbG90T2Zmc2V0KCk7XG4gICAgICAgICAgICBwb3MueCA9IGNsYW1wKDAsIGUucGFnZVggLSBvZmZzZXQubGVmdCAtIHBsb3RPZmZzZXQubGVmdCwgcGxvdC53aWR0aCgpKTtcbiAgICAgICAgICAgIHBvcy55ID0gY2xhbXAoMCwgZS5wYWdlWSAtIG9mZnNldC50b3AgLSBwbG90T2Zmc2V0LnRvcCwgcGxvdC5oZWlnaHQoKSk7XG5cbiAgICAgICAgICAgIGlmIChvLnNlbGVjdGlvbi5tb2RlID09IFwieVwiKVxuICAgICAgICAgICAgICAgIHBvcy54ID0gcG9zID09IHNlbGVjdGlvbi5maXJzdCA/IDAgOiBwbG90LndpZHRoKCk7XG5cbiAgICAgICAgICAgIGlmIChvLnNlbGVjdGlvbi5tb2RlID09IFwieFwiKVxuICAgICAgICAgICAgICAgIHBvcy55ID0gcG9zID09IHNlbGVjdGlvbi5maXJzdCA/IDAgOiBwbG90LmhlaWdodCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKHBvcykge1xuICAgICAgICAgICAgaWYgKHBvcy5wYWdlWCA9PSBudWxsKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgc2V0U2VsZWN0aW9uUG9zKHNlbGVjdGlvbi5zZWNvbmQsIHBvcyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uSXNTYW5lKCkpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uc2hvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgcGxvdC50cmlnZ2VyUmVkcmF3T3ZlcmxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGNsZWFyU2VsZWN0aW9uKHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2xlYXJTZWxlY3Rpb24ocHJldmVudEV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLnNob3cpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uc2hvdyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHBsb3QudHJpZ2dlclJlZHJhd092ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXByZXZlbnRFdmVudClcbiAgICAgICAgICAgICAgICAgICAgcGxvdC5nZXRQbGFjZWhvbGRlcigpLnRyaWdnZXIoXCJwbG90dW5zZWxlY3RlZFwiLCBbIF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZnVuY3Rpb24gdGFrZW4gZnJvbSBtYXJraW5ncyBzdXBwb3J0IGluIEZsb3RcbiAgICAgICAgZnVuY3Rpb24gZXh0cmFjdFJhbmdlKHJhbmdlcywgY29vcmQpIHtcbiAgICAgICAgICAgIHZhciBheGlzLCBmcm9tLCB0bywga2V5LCBheGVzID0gcGxvdC5nZXRBeGVzKCk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gYXhlcykge1xuICAgICAgICAgICAgICAgIGF4aXMgPSBheGVzW2tdO1xuICAgICAgICAgICAgICAgIGlmIChheGlzLmRpcmVjdGlvbiA9PSBjb29yZCkge1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSBjb29yZCArIGF4aXMubiArIFwiYXhpc1wiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJhbmdlc1trZXldICYmIGF4aXMubiA9PSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gY29vcmQgKyBcImF4aXNcIjsgLy8gc3VwcG9ydCB4MWF4aXMgYXMgeGF4aXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tID0gcmFuZ2VzW2tleV0uZnJvbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvID0gcmFuZ2VzW2tleV0udG87XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmFja3dhcmRzLWNvbXBhdCBzdHVmZiAtIHRvIGJlIHJlbW92ZWQgaW4gZnV0dXJlXG4gICAgICAgICAgICBpZiAoIXJhbmdlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgYXhpcyA9IGNvb3JkID09IFwieFwiID8gcGxvdC5nZXRYQXhlcygpWzBdIDogcGxvdC5nZXRZQXhlcygpWzBdO1xuICAgICAgICAgICAgICAgIGZyb20gPSByYW5nZXNbY29vcmQgKyBcIjFcIl07XG4gICAgICAgICAgICAgICAgdG8gPSByYW5nZXNbY29vcmQgKyBcIjJcIl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGF1dG8tcmV2ZXJzZSBhcyBhbiBhZGRlZCBib251c1xuICAgICAgICAgICAgaWYgKGZyb20gIT0gbnVsbCAmJiB0byAhPSBudWxsICYmIGZyb20gPiB0bykge1xuICAgICAgICAgICAgICAgIHZhciB0bXAgPSBmcm9tO1xuICAgICAgICAgICAgICAgIGZyb20gPSB0bztcbiAgICAgICAgICAgICAgICB0byA9IHRtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHsgZnJvbTogZnJvbSwgdG86IHRvLCBheGlzOiBheGlzIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGZ1bmN0aW9uIHNldFNlbGVjdGlvbihyYW5nZXMsIHByZXZlbnRFdmVudCkge1xuICAgICAgICAgICAgdmFyIGF4aXMsIHJhbmdlLCBvID0gcGxvdC5nZXRPcHRpb25zKCk7XG5cbiAgICAgICAgICAgIGlmIChvLnNlbGVjdGlvbi5tb2RlID09IFwieVwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmZpcnN0LnggPSAwO1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5zZWNvbmQueCA9IHBsb3Qud2lkdGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gZXh0cmFjdFJhbmdlKHJhbmdlcywgXCJ4XCIpO1xuXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmZpcnN0LnggPSByYW5nZS5heGlzLnAyYyhyYW5nZS5mcm9tKTtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uc2Vjb25kLnggPSByYW5nZS5heGlzLnAyYyhyYW5nZS50byk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvLnNlbGVjdGlvbi5tb2RlID09IFwieFwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmZpcnN0LnkgPSAwO1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5zZWNvbmQueSA9IHBsb3QuaGVpZ2h0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByYW5nZSA9IGV4dHJhY3RSYW5nZShyYW5nZXMsIFwieVwiKTtcblxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5maXJzdC55ID0gcmFuZ2UuYXhpcy5wMmMocmFuZ2UuZnJvbSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLnNlY29uZC55ID0gcmFuZ2UuYXhpcy5wMmMocmFuZ2UudG8pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZWxlY3Rpb24uc2hvdyA9IHRydWU7XG4gICAgICAgICAgICBwbG90LnRyaWdnZXJSZWRyYXdPdmVybGF5KCk7XG4gICAgICAgICAgICBpZiAoIXByZXZlbnRFdmVudCAmJiBzZWxlY3Rpb25Jc1NhbmUoKSlcbiAgICAgICAgICAgICAgICB0cmlnZ2VyU2VsZWN0ZWRFdmVudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2VsZWN0aW9uSXNTYW5lKCkge1xuICAgICAgICAgICAgdmFyIG1pblNpemUgPSBwbG90LmdldE9wdGlvbnMoKS5zZWxlY3Rpb24ubWluU2l6ZTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhzZWxlY3Rpb24uc2Vjb25kLnggLSBzZWxlY3Rpb24uZmlyc3QueCkgPj0gbWluU2l6ZSAmJlxuICAgICAgICAgICAgICAgIE1hdGguYWJzKHNlbGVjdGlvbi5zZWNvbmQueSAtIHNlbGVjdGlvbi5maXJzdC55KSA+PSBtaW5TaXplO1xuICAgICAgICB9XG5cbiAgICAgICAgcGxvdC5jbGVhclNlbGVjdGlvbiA9IGNsZWFyU2VsZWN0aW9uO1xuICAgICAgICBwbG90LnNldFNlbGVjdGlvbiA9IHNldFNlbGVjdGlvbjtcbiAgICAgICAgcGxvdC5nZXRTZWxlY3Rpb24gPSBnZXRTZWxlY3Rpb247XG5cbiAgICAgICAgcGxvdC5ob29rcy5iaW5kRXZlbnRzLnB1c2goZnVuY3Rpb24ocGxvdCwgZXZlbnRIb2xkZXIpIHtcbiAgICAgICAgICAgIHZhciBvID0gcGxvdC5nZXRPcHRpb25zKCk7XG4gICAgICAgICAgICBpZiAoby5zZWxlY3Rpb24ubW9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZXZlbnRIb2xkZXIubW91c2Vtb3ZlKG9uTW91c2VNb3ZlKTtcbiAgICAgICAgICAgICAgICBldmVudEhvbGRlci5tb3VzZWRvd24ob25Nb3VzZURvd24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIHBsb3QuaG9va3MuZHJhd092ZXJsYXkucHVzaChmdW5jdGlvbiAocGxvdCwgY3R4KSB7XG4gICAgICAgICAgICAvLyBkcmF3IHNlbGVjdGlvblxuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbi5zaG93ICYmIHNlbGVjdGlvbklzU2FuZSgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBsb3RPZmZzZXQgPSBwbG90LmdldFBsb3RPZmZzZXQoKTtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IHBsb3QuZ2V0T3B0aW9ucygpO1xuXG4gICAgICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKHBsb3RPZmZzZXQubGVmdCwgcGxvdE9mZnNldC50b3ApO1xuXG4gICAgICAgICAgICAgICAgdmFyIGMgPSAkLmNvbG9yLnBhcnNlKG8uc2VsZWN0aW9uLmNvbG9yKTtcblxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGMuc2NhbGUoJ2EnLCAwLjgpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVKb2luID0gby5zZWxlY3Rpb24uc2hhcGU7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGMuc2NhbGUoJ2EnLCAwLjQpLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgubWluKHNlbGVjdGlvbi5maXJzdC54LCBzZWxlY3Rpb24uc2Vjb25kLngpICsgMC41LFxuICAgICAgICAgICAgICAgICAgICB5ID0gTWF0aC5taW4oc2VsZWN0aW9uLmZpcnN0LnksIHNlbGVjdGlvbi5zZWNvbmQueSkgKyAwLjUsXG4gICAgICAgICAgICAgICAgICAgIHcgPSBNYXRoLmFicyhzZWxlY3Rpb24uc2Vjb25kLnggLSBzZWxlY3Rpb24uZmlyc3QueCkgLSAxLFxuICAgICAgICAgICAgICAgICAgICBoID0gTWF0aC5hYnMoc2VsZWN0aW9uLnNlY29uZC55IC0gc2VsZWN0aW9uLmZpcnN0LnkpIC0gMTtcblxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCh4LCB5LCB3LCBoKTtcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlUmVjdCh4LCB5LCB3LCBoKTtcblxuICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcGxvdC5ob29rcy5zaHV0ZG93bi5wdXNoKGZ1bmN0aW9uIChwbG90LCBldmVudEhvbGRlcikge1xuICAgICAgICAgICAgZXZlbnRIb2xkZXIudW5iaW5kKFwibW91c2Vtb3ZlXCIsIG9uTW91c2VNb3ZlKTtcbiAgICAgICAgICAgIGV2ZW50SG9sZGVyLnVuYmluZChcIm1vdXNlZG93blwiLCBvbk1vdXNlRG93bik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtb3VzZVVwSGFuZGxlcilcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoXCJtb3VzZXVwXCIsIG1vdXNlVXBIYW5kbGVyKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICAkLnBsb3QucGx1Z2lucy5wdXNoKHtcbiAgICAgICAgaW5pdDogaW5pdCxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgc2VsZWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgbW9kZTogbnVsbCwgLy8gb25lIG9mIG51bGwsIFwieFwiLCBcInlcIiBvciBcInh5XCJcbiAgICAgICAgICAgICAgICBjb2xvcjogXCIjZThjZmFjXCIsXG4gICAgICAgICAgICAgICAgc2hhcGU6IFwicm91bmRcIiwgLy8gb25lIG9mIFwicm91bmRcIiwgXCJtaXRlclwiLCBvciBcImJldmVsXCJcbiAgICAgICAgICAgICAgICBtaW5TaXplOiA1IC8vIG1pbmltdW0gbnVtYmVyIG9mIHBpeGVsc1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBuYW1lOiAnc2VsZWN0aW9uJyxcbiAgICAgICAgdmVyc2lvbjogJzEuMSdcbiAgICB9KTtcbn0pKGpRdWVyeSk7XG4iXX0="}